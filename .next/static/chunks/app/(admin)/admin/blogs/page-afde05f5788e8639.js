(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2522],{1108:function(e,t,s){Promise.resolve().then(s.bind(s,9605))},9605:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return v}});var l=s(3890),a=s(8496),i=s(7945),r=s(376),c=s(9083),n=s(5741),d=s(8756),o=s(1015),h=s(401),x=s(3820),u=s(7015),m=s(7373),j=s(8837),p=s(319),g=s(8354),f=s(6932),b=s(1680),y=s(6664);let N=y.Ry({title:y.Z_().min(1,"Title is required"),excerpt:y.Z_().min(1,"Excerpt is required"),content:y.Z_().min(1,"Content is required"),author:y.Z_().min(1,"Author is required"),category:y.Z_().min(1,"Category is required"),image:y.Z_().optional(),published:y.O7()});function v(){var e;let{isAuthenticated:t}=(0,i.J)(),[s,y]=(0,a.useState)([]),[v,w]=(0,a.useState)(!0),[C,_]=(0,a.useState)(!1),[S,k]=(0,a.useState)(null),[F,Z]=(0,a.useState)(!1),[E,z]=(0,a.useState)(""),{register:A,handleSubmit:B,formState:{errors:T},reset:D,setValue:I,watch:O}=(0,f.cI)({resolver:(0,b.F)(N),defaultValues:{published:!1}});(0,a.useEffect)(()=>{P()},[]);let P=async()=>{try{let e=await fetch("".concat("","/api/blogs")),t=await e.json();y(t)}catch(e){console.error("Failed to fetch blogs:",e)}finally{w(!1)}},q=async e=>{if(t){Z(!0);try{let t=new FormData;t.append("image",e);let s=await fetch("".concat("","/api/admin/upload"),{method:"POST",body:t});if(!s.ok)throw Error("Upload failed");let l=await s.json();z(l.url),I("image",l.url)}catch(e){console.error("Image upload failed:",e),alert("Failed to upload image")}finally{Z(!1)}}},U=e=>{k(e),z(e.image||""),D({title:e.title,excerpt:e.excerpt,content:e.content,author:e.author,category:e.category,image:e.image,published:e.published}),_(!0)},V=async e=>{if(t)try{let t={...e,image:E},s=S?"".concat("","/api/blogs/").concat(S._id):"".concat("","/api/blogs");if(!(await fetch(s,{method:S?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to save blog");_(!1),P(),D(),z("")}catch(e){console.error("Failed to save blog:",e),alert("Failed to save blog")}},L=async e=>{if(t&&confirm("Are you sure you want to delete this blog?"))try{if(!(await fetch("".concat("","/api/blogs/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete blog");P()}catch(e){console.error("Failed to delete blog:",e),alert("Failed to delete blog")}};return v?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Blogs"}),(0,l.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage your blog posts"})]}),(0,l.jsxs)(c.z,{onClick:()=>{k(null),z(""),D({published:!1}),_(!0)},children:[(0,l.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Add Blog"]})]}),(0,l.jsx)(r.Zb,{children:(0,l.jsx)(r.aY,{className:"p-0",children:(0,l.jsxs)(o.iA,{children:[(0,l.jsx)(o.xD,{children:(0,l.jsxs)(o.SC,{children:[(0,l.jsx)(o.ss,{children:"Title"}),(0,l.jsx)(o.ss,{children:"Author"}),(0,l.jsx)(o.ss,{children:"Category"}),(0,l.jsx)(o.ss,{children:"Status"}),(0,l.jsx)(o.ss,{children:"Created"}),(0,l.jsx)(o.ss,{className:"text-right",children:"Actions"})]})}),(0,l.jsx)(o.RM,{children:0===s.length?(0,l.jsx)(o.SC,{children:(0,l.jsx)(o.pj,{colSpan:6,className:"text-center py-8 text-gray-500",children:"No blogs found"})}):s.map(e=>(0,l.jsxs)(o.SC,{children:[(0,l.jsx)(o.pj,{className:"font-medium",children:e.title}),(0,l.jsx)(o.pj,{children:e.author}),(0,l.jsx)(o.pj,{children:e.category}),(0,l.jsx)(o.pj,{children:e.published?(0,l.jsx)("span",{className:"text-green-600",children:"Published"}):(0,l.jsx)("span",{className:"text-gray-500",children:"Draft"})}),(0,l.jsx)(o.pj,{children:new Date(e.createdAt).toLocaleDateString()}),(0,l.jsx)(o.pj,{className:"text-right",children:(0,l.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,l.jsx)(c.z,{variant:"ghost",size:"icon",onClick:()=>U(e),children:(0,l.jsx)(m.Z,{className:"h-4 w-4"})}),(0,l.jsx)(c.z,{variant:"ghost",size:"icon",onClick:()=>L(e._id),children:(0,l.jsx)(j.Z,{className:"h-4 w-4 text-red-500"})})]})})]},e._id))})]})})}),(0,l.jsx)(h.Vq,{open:C,onOpenChange:_,children:(0,l.jsxs)(h.cZ,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)(h.fK,{children:[(0,l.jsx)(h.$N,{children:S?"Edit Blog":"Create Blog"}),(0,l.jsx)(h.Be,{children:S?"Update blog information":"Add a new blog post"})]}),(0,l.jsxs)("form",{onSubmit:B(V),className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(d._,{htmlFor:"title",children:"Title *"}),(0,l.jsx)(n.I,{id:"title",...A("title")}),T.title&&(0,l.jsx)("p",{className:"text-sm text-red-500",children:T.title.message})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(d._,{htmlFor:"excerpt",children:"Excerpt *"}),(0,l.jsx)("textarea",{id:"excerpt",...A("excerpt"),className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm",rows:3}),T.excerpt&&(0,l.jsx)("p",{className:"text-sm text-red-500",children:T.excerpt.message})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(d._,{htmlFor:"content",children:"Content *"}),(0,l.jsx)("textarea",{id:"content",...A("content"),className:"flex min-h-[200px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm",rows:10}),T.content&&(0,l.jsx)("p",{className:"text-sm text-red-500",children:T.content.message})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(d._,{htmlFor:"author",children:"Author *"}),(0,l.jsx)(n.I,{id:"author",...A("author")}),T.author&&(0,l.jsx)("p",{className:"text-sm text-red-500",children:T.author.message})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(d._,{htmlFor:"category",children:"Category *"}),(0,l.jsx)(n.I,{id:"category",...A("category")}),T.category&&(0,l.jsx)("p",{className:"text-sm text-red-500",children:T.category.message})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(d._,{children:"Blog Image"}),(0,l.jsxs)("div",{className:"mt-2 space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(n.I,{type:"file",accept:"image/*",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&q(s)},disabled:F,className:"flex-1"}),F&&(0,l.jsx)(p.Z,{className:"h-4 w-4 animate-spin"})]}),E&&(0,l.jsxs)("div",{className:"relative w-full h-48",children:[(0,l.jsx)("img",{src:"".concat("").concat(E),alt:"Blog",className:"w-full h-full object-cover rounded border"}),(0,l.jsx)(c.z,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2",onClick:()=>{z(""),I("image","")},children:(0,l.jsx)(g.Z,{className:"h-4 w-4"})})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(d._,{htmlFor:"published",children:"Status"}),(0,l.jsxs)(x.Ph,{onValueChange:e=>I("published","true"===e),defaultValue:null===(e=O("published"))||void 0===e?void 0:e.toString(),children:[(0,l.jsx)(x.i4,{children:(0,l.jsx)(x.ki,{})}),(0,l.jsxs)(x.Bw,{children:[(0,l.jsx)(x.Ql,{value:"false",children:"Draft"}),(0,l.jsx)(x.Ql,{value:"true",children:"Published"})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,l.jsx)(c.z,{type:"button",variant:"outline",onClick:()=>_(!1),children:"Cancel"}),(0,l.jsxs)(c.z,{type:"submit",children:[S?"Update":"Create"," Blog"]})]})]})]})})]})}},319:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(331).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])}},function(e){e.O(0,[8741,5669,396,8568,5399,846,4385,9649,2945,1744],function(){return e(e.s=1108)}),_N_E=e.O()}]);