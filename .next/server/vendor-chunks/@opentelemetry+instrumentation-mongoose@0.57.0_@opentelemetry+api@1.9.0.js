"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0";
exports.ids = ["vendor-chunks/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/index.js":
/*!****************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/index.js ***!
  \****************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.MongooseInstrumentation = void 0;\n/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar mongoose_1 = __webpack_require__(/*! ./mongoose */ \"(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/mongoose.js\");\nObject.defineProperty(exports, \"MongooseInstrumentation\", ({ enumerable: true, get: function () { return mongoose_1.MongooseInstrumentation; } }));\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQG9wZW50ZWxlbWV0cnkraW5zdHJ1bWVudGF0aW9uLW1vbmdvb3NlQDAuNTcuMF9Ab3BlbnRlbGVtZXRyeSthcGlAMS45LjAvbm9kZV9tb2R1bGVzL0BvcGVudGVsZW1ldHJ5L2luc3RydW1lbnRhdGlvbi1tb25nb29zZS9idWlsZC9zcmMvaW5kZXguanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixtQkFBTyxDQUFDLGlNQUFZO0FBQ3JDLDJEQUEwRCxFQUFFLHFDQUFxQyw4Q0FBOEMsRUFBQztBQUNoSiIsInNvdXJjZXMiOlsid2VicGFjazovL2xlaWluZGlhcy8uL25vZGVfbW9kdWxlcy8ucG5wbS9Ab3BlbnRlbGVtZXRyeStpbnN0cnVtZW50YXRpb24tbW9uZ29vc2VAMC41Ny4wX0BvcGVudGVsZW1ldHJ5K2FwaUAxLjkuMC9ub2RlX21vZHVsZXMvQG9wZW50ZWxlbWV0cnkvaW5zdHJ1bWVudGF0aW9uLW1vbmdvb3NlL2J1aWxkL3NyYy9pbmRleC5qcz8zZWVmIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5Nb25nb29zZUluc3RydW1lbnRhdGlvbiA9IHZvaWQgMDtcbi8qXG4gKiBDb3B5cmlnaHQgVGhlIE9wZW5UZWxlbWV0cnkgQXV0aG9yc1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHBzOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG52YXIgbW9uZ29vc2VfMSA9IHJlcXVpcmUoXCIuL21vbmdvb3NlXCIpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiTW9uZ29vc2VJbnN0cnVtZW50YXRpb25cIiwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG1vbmdvb3NlXzEuTW9uZ29vc2VJbnN0cnVtZW50YXRpb247IH0gfSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/mongoose.js":
/*!*******************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/mongoose.js ***!
  \*******************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.MongooseInstrumentation = exports._ALREADY_INSTRUMENTED = exports._STORED_PARENT_SPAN = void 0;\n/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst api_1 = __webpack_require__(/*! @opentelemetry/api */ \"(ssr)/./node_modules/.pnpm/@opentelemetry+api@1.9.0/node_modules/@opentelemetry/api/build/esm/index.js\");\nconst core_1 = __webpack_require__(/*! @opentelemetry/core */ \"(ssr)/./node_modules/.pnpm/@opentelemetry+core@2.5.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/core/build/esm/index.js\");\nconst utils_1 = __webpack_require__(/*! ./utils */ \"(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/utils.js\");\nconst instrumentation_1 = __webpack_require__(/*! @opentelemetry/instrumentation */ \"(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation@0.211.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation/build/esm/index.js\");\n/** @knipignore */\nconst version_1 = __webpack_require__(/*! ./version */ \"(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/version.js\");\nconst semconv_1 = __webpack_require__(/*! ./semconv */ \"(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/semconv.js\");\nconst semantic_conventions_1 = __webpack_require__(/*! @opentelemetry/semantic-conventions */ \"(ssr)/./node_modules/.pnpm/@opentelemetry+semantic-conventions@1.39.0/node_modules/@opentelemetry/semantic-conventions/build/esm/index.js\");\nconst contextCaptureFunctionsCommon = [\n    'deleteOne',\n    'deleteMany',\n    'find',\n    'findOne',\n    'estimatedDocumentCount',\n    'countDocuments',\n    'distinct',\n    'where',\n    '$where',\n    'findOneAndUpdate',\n    'findOneAndDelete',\n    'findOneAndReplace',\n];\nconst contextCaptureFunctions6 = [\n    'remove',\n    'count',\n    'findOneAndRemove',\n    ...contextCaptureFunctionsCommon,\n];\nconst contextCaptureFunctions7 = [\n    'count',\n    'findOneAndRemove',\n    ...contextCaptureFunctionsCommon,\n];\nconst contextCaptureFunctions8 = [...contextCaptureFunctionsCommon];\nfunction getContextCaptureFunctions(moduleVersion) {\n    /* istanbul ignore next */\n    if (!moduleVersion) {\n        return contextCaptureFunctionsCommon;\n    }\n    else if (moduleVersion.startsWith('6.') || moduleVersion.startsWith('5.')) {\n        return contextCaptureFunctions6;\n    }\n    else if (moduleVersion.startsWith('7.')) {\n        return contextCaptureFunctions7;\n    }\n    else {\n        return contextCaptureFunctions8;\n    }\n}\nfunction instrumentRemove(moduleVersion) {\n    return ((moduleVersion &&\n        (moduleVersion.startsWith('5.') || moduleVersion.startsWith('6.'))) ||\n        false);\n}\n/**\n * 8.21.0 changed Document.updateOne/deleteOne so that the Query is not fully built when Query.exec() is called.\n * @param moduleVersion\n */\nfunction needsDocumentMethodPatch(moduleVersion) {\n    if (!moduleVersion || !moduleVersion.startsWith('8.')) {\n        return false;\n    }\n    const minor = parseInt(moduleVersion.split('.')[1], 10);\n    return minor >= 21;\n}\n// when mongoose functions are called, we store the original call context\n// and then set it as the parent for the spans created by Query/Aggregate exec()\n// calls. this bypass the unlinked spans issue on thenables await operations.\nexports._STORED_PARENT_SPAN = Symbol('stored-parent-span');\n// Prevents double-instrumentation when doc.updateOne/deleteOne (Mongoose 8.21.0+)\n// creates a span and returns a Query that also calls exec()\nexports._ALREADY_INSTRUMENTED = Symbol('already-instrumented');\nclass MongooseInstrumentation extends instrumentation_1.InstrumentationBase {\n    _netSemconvStability;\n    _dbSemconvStability;\n    constructor(config = {}) {\n        super(version_1.PACKAGE_NAME, version_1.PACKAGE_VERSION, config);\n        this._setSemconvStabilityFromEnv();\n    }\n    // Used for testing.\n    _setSemconvStabilityFromEnv() {\n        this._netSemconvStability = (0, instrumentation_1.semconvStabilityFromStr)('http', process.env.OTEL_SEMCONV_STABILITY_OPT_IN);\n        this._dbSemconvStability = (0, instrumentation_1.semconvStabilityFromStr)('database', process.env.OTEL_SEMCONV_STABILITY_OPT_IN);\n    }\n    init() {\n        const module = new instrumentation_1.InstrumentationNodeModuleDefinition('mongoose', ['>=5.9.7 <9'], this.patch.bind(this), this.unpatch.bind(this));\n        return module;\n    }\n    patch(module, moduleVersion) {\n        const moduleExports = module[Symbol.toStringTag] === 'Module'\n            ? module.default // ESM\n            : module; // CommonJS\n        this._wrap(moduleExports.Model.prototype, 'save', this.patchOnModelMethods('save', moduleVersion));\n        // mongoose applies this code on module require:\n        // Model.prototype.$save = Model.prototype.save;\n        // which captures the save function before it is patched.\n        // so we need to apply the same logic after instrumenting the save function.\n        moduleExports.Model.prototype.$save = moduleExports.Model.prototype.save;\n        if (instrumentRemove(moduleVersion)) {\n            this._wrap(moduleExports.Model.prototype, 'remove', this.patchOnModelMethods('remove', moduleVersion));\n        }\n        // Mongoose 8.21.0+ changed Document.updateOne()/deleteOne() so that the Query is not fully built when Query.exec() is called.\n        //\n        // See https://github.com/Automattic/mongoose/blob/7dbda12dca1bd7adb9e270d7de8ac5229606ce72/lib/document.js#L861.\n        // - `this` is a Query object\n        // - the update happens in a pre-hook that gets called when Query.exec() is already running.\n        // - when we instrument Query.exec(), we don't have access to the options yet as they get set during Query.exec() only.\n        //\n        // Unfortunately, after Query.exec() is finished, the options are left modified by the library, so just delaying\n        // attaching the attributes after the span is done is not an option. Therefore, we patch Model methods\n        // and grab the data directly where the user provides it.\n        //\n        // ref: https://github.com/Automattic/mongoose/pull/15908 (introduced this behavior)\n        if (needsDocumentMethodPatch(moduleVersion)) {\n            this._wrap(moduleExports.Model.prototype, 'updateOne', this._patchDocumentUpdateMethods('updateOne', moduleVersion));\n            this._wrap(moduleExports.Model.prototype, 'deleteOne', this._patchDocumentUpdateMethods('deleteOne', moduleVersion));\n        }\n        this._wrap(moduleExports.Query.prototype, 'exec', this.patchQueryExec(moduleVersion));\n        this._wrap(moduleExports.Aggregate.prototype, 'exec', this.patchAggregateExec(moduleVersion));\n        const contextCaptureFunctions = getContextCaptureFunctions(moduleVersion);\n        contextCaptureFunctions.forEach((funcName) => {\n            this._wrap(moduleExports.Query.prototype, funcName, this.patchAndCaptureSpanContext(funcName));\n        });\n        this._wrap(moduleExports.Model, 'aggregate', this.patchModelAggregate());\n        this._wrap(moduleExports.Model, 'insertMany', this.patchModelStatic('insertMany', moduleVersion));\n        this._wrap(moduleExports.Model, 'bulkWrite', this.patchModelStatic('bulkWrite', moduleVersion));\n        return moduleExports;\n    }\n    unpatch(module, moduleVersion) {\n        const moduleExports = module[Symbol.toStringTag] === 'Module'\n            ? module.default // ESM\n            : module; // CommonJS\n        const contextCaptureFunctions = getContextCaptureFunctions(moduleVersion);\n        this._unwrap(moduleExports.Model.prototype, 'save');\n        // revert the patch for $save which we applied by aliasing it to patched `save`\n        moduleExports.Model.prototype.$save = moduleExports.Model.prototype.save;\n        if (instrumentRemove(moduleVersion)) {\n            this._unwrap(moduleExports.Model.prototype, 'remove');\n        }\n        if (needsDocumentMethodPatch(moduleVersion)) {\n            this._unwrap(moduleExports.Model.prototype, 'updateOne');\n            this._unwrap(moduleExports.Model.prototype, 'deleteOne');\n        }\n        this._unwrap(moduleExports.Query.prototype, 'exec');\n        this._unwrap(moduleExports.Aggregate.prototype, 'exec');\n        contextCaptureFunctions.forEach((funcName) => {\n            this._unwrap(moduleExports.Query.prototype, funcName);\n        });\n        this._unwrap(moduleExports.Model, 'aggregate');\n        this._unwrap(moduleExports.Model, 'insertMany');\n        this._unwrap(moduleExports.Model, 'bulkWrite');\n    }\n    patchAggregateExec(moduleVersion) {\n        const self = this;\n        return (originalAggregate) => {\n            return function exec(callback) {\n                if (self.getConfig().requireParentSpan &&\n                    api_1.trace.getSpan(api_1.context.active()) === undefined) {\n                    return originalAggregate.apply(this, arguments);\n                }\n                const parentSpan = this[exports._STORED_PARENT_SPAN];\n                const attributes = {};\n                const { dbStatementSerializer } = self.getConfig();\n                if (dbStatementSerializer) {\n                    const statement = dbStatementSerializer('aggregate', {\n                        options: this.options,\n                        aggregatePipeline: this._pipeline,\n                    });\n                    if (self._dbSemconvStability & instrumentation_1.SemconvStability.OLD) {\n                        attributes[semconv_1.ATTR_DB_STATEMENT] = statement;\n                    }\n                    if (self._dbSemconvStability & instrumentation_1.SemconvStability.STABLE) {\n                        attributes[semantic_conventions_1.ATTR_DB_QUERY_TEXT] = statement;\n                    }\n                }\n                const span = self._startSpan(this._model.collection, this._model?.modelName, 'aggregate', attributes, parentSpan);\n                return self._handleResponse(span, originalAggregate, this, arguments, callback, moduleVersion);\n            };\n        };\n    }\n    patchQueryExec(moduleVersion) {\n        const self = this;\n        return (originalExec) => {\n            return function exec(callback) {\n                // Skip if already instrumented by document instance method patch\n                if (this[exports._ALREADY_INSTRUMENTED]) {\n                    return originalExec.apply(this, arguments);\n                }\n                if (self.getConfig().requireParentSpan &&\n                    api_1.trace.getSpan(api_1.context.active()) === undefined) {\n                    return originalExec.apply(this, arguments);\n                }\n                const parentSpan = this[exports._STORED_PARENT_SPAN];\n                const attributes = {};\n                const { dbStatementSerializer } = self.getConfig();\n                if (dbStatementSerializer) {\n                    const statement = dbStatementSerializer(this.op, {\n                        // Use public API methods (getFilter/getOptions) for better compatibility\n                        condition: this.getFilter?.() ?? this._conditions,\n                        updates: this._update,\n                        options: this.getOptions?.() ?? this.options,\n                        fields: this._fields,\n                    });\n                    if (self._dbSemconvStability & instrumentation_1.SemconvStability.OLD) {\n                        attributes[semconv_1.ATTR_DB_STATEMENT] = statement;\n                    }\n                    if (self._dbSemconvStability & instrumentation_1.SemconvStability.STABLE) {\n                        attributes[semantic_conventions_1.ATTR_DB_QUERY_TEXT] = statement;\n                    }\n                }\n                const span = self._startSpan(this.mongooseCollection, this.model.modelName, this.op, attributes, parentSpan);\n                return self._handleResponse(span, originalExec, this, arguments, callback, moduleVersion);\n            };\n        };\n    }\n    patchOnModelMethods(op, moduleVersion) {\n        const self = this;\n        return (originalOnModelFunction) => {\n            return function method(options, callback) {\n                if (self.getConfig().requireParentSpan &&\n                    api_1.trace.getSpan(api_1.context.active()) === undefined) {\n                    return originalOnModelFunction.apply(this, arguments);\n                }\n                const serializePayload = { document: this };\n                if (options && !(options instanceof Function)) {\n                    serializePayload.options = options;\n                }\n                const attributes = {};\n                const { dbStatementSerializer } = self.getConfig();\n                if (dbStatementSerializer) {\n                    const statement = dbStatementSerializer(op, serializePayload);\n                    if (self._dbSemconvStability & instrumentation_1.SemconvStability.OLD) {\n                        attributes[semconv_1.ATTR_DB_STATEMENT] = statement;\n                    }\n                    if (self._dbSemconvStability & instrumentation_1.SemconvStability.STABLE) {\n                        attributes[semantic_conventions_1.ATTR_DB_QUERY_TEXT] = statement;\n                    }\n                }\n                const span = self._startSpan(this.constructor.collection, this.constructor.modelName, op, attributes);\n                if (options instanceof Function) {\n                    callback = options;\n                    options = undefined;\n                }\n                return self._handleResponse(span, originalOnModelFunction, this, arguments, callback, moduleVersion);\n            };\n        };\n    }\n    // Patch document instance methods (doc.updateOne/deleteOne) for Mongoose 8.21.0+.\n    _patchDocumentUpdateMethods(op, moduleVersion) {\n        const self = this;\n        return (originalMethod) => {\n            return function method(update, options, callback) {\n                if (self.getConfig().requireParentSpan &&\n                    api_1.trace.getSpan(api_1.context.active()) === undefined) {\n                    return originalMethod.apply(this, arguments);\n                }\n                // determine actual callback since different argument patterns are allowed\n                let actualCallback = callback;\n                let actualUpdate = update;\n                let actualOptions = options;\n                if (typeof update === 'function') {\n                    actualCallback = update;\n                    actualUpdate = undefined;\n                    actualOptions = undefined;\n                }\n                else if (typeof options === 'function') {\n                    actualCallback = options;\n                    actualOptions = undefined;\n                }\n                const attributes = {};\n                const dbStatementSerializer = self.getConfig().dbStatementSerializer;\n                if (dbStatementSerializer) {\n                    const statement = dbStatementSerializer(op, {\n                        // Document instance methods automatically use the document's _id as filter\n                        condition: { _id: this._id },\n                        updates: actualUpdate,\n                        options: actualOptions,\n                    });\n                    if (self._dbSemconvStability & instrumentation_1.SemconvStability.OLD) {\n                        attributes[semconv_1.ATTR_DB_STATEMENT] = statement;\n                    }\n                    if (self._dbSemconvStability & instrumentation_1.SemconvStability.STABLE) {\n                        attributes[semantic_conventions_1.ATTR_DB_QUERY_TEXT] = statement;\n                    }\n                }\n                const span = self._startSpan(this.constructor.collection, this.constructor.modelName, op, attributes);\n                const result = self._handleResponse(span, originalMethod, this, arguments, actualCallback, moduleVersion);\n                // Mark returned Query to prevent double-instrumentation when exec() is eventually called\n                if (result && typeof result === 'object') {\n                    result[exports._ALREADY_INSTRUMENTED] = true;\n                }\n                return result;\n            };\n        };\n    }\n    patchModelStatic(op, moduleVersion) {\n        const self = this;\n        return (original) => {\n            return function patchedStatic(docsOrOps, options, callback) {\n                if (self.getConfig().requireParentSpan &&\n                    api_1.trace.getSpan(api_1.context.active()) === undefined) {\n                    return original.apply(this, arguments);\n                }\n                if (typeof options === 'function') {\n                    callback = options;\n                    options = undefined;\n                }\n                const serializePayload = {};\n                switch (op) {\n                    case 'insertMany':\n                        serializePayload.documents = docsOrOps;\n                        break;\n                    case 'bulkWrite':\n                        serializePayload.operations = docsOrOps;\n                        break;\n                    default:\n                        serializePayload.document = docsOrOps;\n                        break;\n                }\n                if (options !== undefined) {\n                    serializePayload.options = options;\n                }\n                const attributes = {};\n                const { dbStatementSerializer } = self.getConfig();\n                if (dbStatementSerializer) {\n                    const statement = dbStatementSerializer(op, serializePayload);\n                    if (self._dbSemconvStability & instrumentation_1.SemconvStability.OLD) {\n                        attributes[semconv_1.ATTR_DB_STATEMENT] = statement;\n                    }\n                    if (self._dbSemconvStability & instrumentation_1.SemconvStability.STABLE) {\n                        attributes[semantic_conventions_1.ATTR_DB_QUERY_TEXT] = statement;\n                    }\n                }\n                const span = self._startSpan(this.collection, this.modelName, op, attributes);\n                return self._handleResponse(span, original, this, arguments, callback, moduleVersion);\n            };\n        };\n    }\n    // we want to capture the otel span on the object which is calling exec.\n    // in the special case of aggregate, we need have no function to path\n    // on the Aggregate object to capture the context on, so we patch\n    // the aggregate of Model, and set the context on the Aggregate object\n    patchModelAggregate() {\n        const self = this;\n        return (original) => {\n            return function captureSpanContext() {\n                const currentSpan = api_1.trace.getSpan(api_1.context.active());\n                const aggregate = self._callOriginalFunction(() => original.apply(this, arguments));\n                if (aggregate)\n                    aggregate[exports._STORED_PARENT_SPAN] = currentSpan;\n                return aggregate;\n            };\n        };\n    }\n    patchAndCaptureSpanContext(funcName) {\n        const self = this;\n        return (original) => {\n            return function captureSpanContext() {\n                this[exports._STORED_PARENT_SPAN] = api_1.trace.getSpan(api_1.context.active());\n                return self._callOriginalFunction(() => original.apply(this, arguments));\n            };\n        };\n    }\n    _startSpan(collection, modelName, operation, attributes, parentSpan) {\n        const finalAttributes = {\n            ...attributes,\n            ...(0, utils_1.getAttributesFromCollection)(collection, this._dbSemconvStability, this._netSemconvStability),\n        };\n        if (this._dbSemconvStability & instrumentation_1.SemconvStability.OLD) {\n            finalAttributes[semconv_1.ATTR_DB_OPERATION] = operation;\n            finalAttributes[semconv_1.ATTR_DB_SYSTEM] = 'mongoose'; // keep for backwards compatibility\n        }\n        if (this._dbSemconvStability & instrumentation_1.SemconvStability.STABLE) {\n            finalAttributes[semantic_conventions_1.ATTR_DB_OPERATION_NAME] = operation;\n            finalAttributes[semantic_conventions_1.ATTR_DB_SYSTEM_NAME] = semconv_1.DB_SYSTEM_NAME_VALUE_MONGODB; // actual db system name\n        }\n        const spanName = this._dbSemconvStability & instrumentation_1.SemconvStability.STABLE\n            ? `${operation} ${collection.name}`\n            : `mongoose.${modelName}.${operation}`;\n        return this.tracer.startSpan(spanName, {\n            kind: api_1.SpanKind.CLIENT,\n            attributes: finalAttributes,\n        }, parentSpan ? api_1.trace.setSpan(api_1.context.active(), parentSpan) : undefined);\n    }\n    _handleResponse(span, exec, originalThis, args, callback, moduleVersion = undefined) {\n        const self = this;\n        if (callback instanceof Function) {\n            return self._callOriginalFunction(() => (0, utils_1.handleCallbackResponse)(callback, exec, originalThis, span, args, self.getConfig().responseHook, moduleVersion));\n        }\n        else {\n            const response = self._callOriginalFunction(() => exec.apply(originalThis, args));\n            return (0, utils_1.handlePromiseResponse)(response, span, self.getConfig().responseHook, moduleVersion);\n        }\n    }\n    _callOriginalFunction(originalFunction) {\n        if (this.getConfig().suppressInternalInstrumentation) {\n            return api_1.context.with((0, core_1.suppressTracing)(api_1.context.active()), originalFunction);\n        }\n        else {\n            return originalFunction();\n        }\n    }\n}\nexports.MongooseInstrumentation = MongooseInstrumentation;\n//# sourceMappingURL=mongoose.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQG9wZW50ZWxlbWV0cnkraW5zdHJ1bWVudGF0aW9uLW1vbmdvb3NlQDAuNTcuMF9Ab3BlbnRlbGVtZXRyeSthcGlAMS45LjAvbm9kZV9tb2R1bGVzL0BvcGVudGVsZW1ldHJ5L2luc3RydW1lbnRhdGlvbi1tb25nb29zZS9idWlsZC9zcmMvbW9uZ29vc2UuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsK0JBQStCLEdBQUcsNkJBQTZCLEdBQUcsMkJBQTJCO0FBQzdGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsbUJBQU8sQ0FBQyxrSUFBb0I7QUFDMUMsZUFBZSxtQkFBTyxDQUFDLDhKQUFxQjtBQUM1QyxnQkFBZ0IsbUJBQU8sQ0FBQywyTEFBUztBQUNqQywwQkFBMEIsbUJBQU8sQ0FBQyxpTUFBZ0M7QUFDbEU7QUFDQSxrQkFBa0IsbUJBQU8sQ0FBQywrTEFBVztBQUNyQyxrQkFBa0IsbUJBQU8sQ0FBQywrTEFBVztBQUNyQywrQkFBK0IsbUJBQU8sQ0FBQyxzTEFBcUM7QUFDNUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix3QkFBd0I7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix3QkFBd0I7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix3QkFBd0I7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLGVBQWU7QUFDcEQ7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isd0JBQXdCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0VBQW9FO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBLGtIQUFrSDtBQUNsSDtBQUNBO0FBQ0EsaUJBQWlCLFdBQVcsRUFBRSxnQkFBZ0I7QUFDOUMsMEJBQTBCLFVBQVUsR0FBRyxVQUFVO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbGVpaW5kaWFzLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BvcGVudGVsZW1ldHJ5K2luc3RydW1lbnRhdGlvbi1tb25nb29zZUAwLjU3LjBfQG9wZW50ZWxlbWV0cnkrYXBpQDEuOS4wL25vZGVfbW9kdWxlcy9Ab3BlbnRlbGVtZXRyeS9pbnN0cnVtZW50YXRpb24tbW9uZ29vc2UvYnVpbGQvc3JjL21vbmdvb3NlLmpzP2YyZGQiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLk1vbmdvb3NlSW5zdHJ1bWVudGF0aW9uID0gZXhwb3J0cy5fQUxSRUFEWV9JTlNUUlVNRU5URUQgPSBleHBvcnRzLl9TVE9SRURfUEFSRU5UX1NQQU4gPSB2b2lkIDA7XG4vKlxuICogQ29weXJpZ2h0IFRoZSBPcGVuVGVsZW1ldHJ5IEF1dGhvcnNcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwczovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgYXBpXzEgPSByZXF1aXJlKFwiQG9wZW50ZWxlbWV0cnkvYXBpXCIpO1xuY29uc3QgY29yZV8xID0gcmVxdWlyZShcIkBvcGVudGVsZW1ldHJ5L2NvcmVcIik7XG5jb25zdCB1dGlsc18xID0gcmVxdWlyZShcIi4vdXRpbHNcIik7XG5jb25zdCBpbnN0cnVtZW50YXRpb25fMSA9IHJlcXVpcmUoXCJAb3BlbnRlbGVtZXRyeS9pbnN0cnVtZW50YXRpb25cIik7XG4vKiogQGtuaXBpZ25vcmUgKi9cbmNvbnN0IHZlcnNpb25fMSA9IHJlcXVpcmUoXCIuL3ZlcnNpb25cIik7XG5jb25zdCBzZW1jb252XzEgPSByZXF1aXJlKFwiLi9zZW1jb252XCIpO1xuY29uc3Qgc2VtYW50aWNfY29udmVudGlvbnNfMSA9IHJlcXVpcmUoXCJAb3BlbnRlbGVtZXRyeS9zZW1hbnRpYy1jb252ZW50aW9uc1wiKTtcbmNvbnN0IGNvbnRleHRDYXB0dXJlRnVuY3Rpb25zQ29tbW9uID0gW1xuICAgICdkZWxldGVPbmUnLFxuICAgICdkZWxldGVNYW55JyxcbiAgICAnZmluZCcsXG4gICAgJ2ZpbmRPbmUnLFxuICAgICdlc3RpbWF0ZWREb2N1bWVudENvdW50JyxcbiAgICAnY291bnREb2N1bWVudHMnLFxuICAgICdkaXN0aW5jdCcsXG4gICAgJ3doZXJlJyxcbiAgICAnJHdoZXJlJyxcbiAgICAnZmluZE9uZUFuZFVwZGF0ZScsXG4gICAgJ2ZpbmRPbmVBbmREZWxldGUnLFxuICAgICdmaW5kT25lQW5kUmVwbGFjZScsXG5dO1xuY29uc3QgY29udGV4dENhcHR1cmVGdW5jdGlvbnM2ID0gW1xuICAgICdyZW1vdmUnLFxuICAgICdjb3VudCcsXG4gICAgJ2ZpbmRPbmVBbmRSZW1vdmUnLFxuICAgIC4uLmNvbnRleHRDYXB0dXJlRnVuY3Rpb25zQ29tbW9uLFxuXTtcbmNvbnN0IGNvbnRleHRDYXB0dXJlRnVuY3Rpb25zNyA9IFtcbiAgICAnY291bnQnLFxuICAgICdmaW5kT25lQW5kUmVtb3ZlJyxcbiAgICAuLi5jb250ZXh0Q2FwdHVyZUZ1bmN0aW9uc0NvbW1vbixcbl07XG5jb25zdCBjb250ZXh0Q2FwdHVyZUZ1bmN0aW9uczggPSBbLi4uY29udGV4dENhcHR1cmVGdW5jdGlvbnNDb21tb25dO1xuZnVuY3Rpb24gZ2V0Q29udGV4dENhcHR1cmVGdW5jdGlvbnMobW9kdWxlVmVyc2lvbikge1xuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgaWYgKCFtb2R1bGVWZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiBjb250ZXh0Q2FwdHVyZUZ1bmN0aW9uc0NvbW1vbjtcbiAgICB9XG4gICAgZWxzZSBpZiAobW9kdWxlVmVyc2lvbi5zdGFydHNXaXRoKCc2LicpIHx8IG1vZHVsZVZlcnNpb24uc3RhcnRzV2l0aCgnNS4nKSkge1xuICAgICAgICByZXR1cm4gY29udGV4dENhcHR1cmVGdW5jdGlvbnM2O1xuICAgIH1cbiAgICBlbHNlIGlmIChtb2R1bGVWZXJzaW9uLnN0YXJ0c1dpdGgoJzcuJykpIHtcbiAgICAgICAgcmV0dXJuIGNvbnRleHRDYXB0dXJlRnVuY3Rpb25zNztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBjb250ZXh0Q2FwdHVyZUZ1bmN0aW9uczg7XG4gICAgfVxufVxuZnVuY3Rpb24gaW5zdHJ1bWVudFJlbW92ZShtb2R1bGVWZXJzaW9uKSB7XG4gICAgcmV0dXJuICgobW9kdWxlVmVyc2lvbiAmJlxuICAgICAgICAobW9kdWxlVmVyc2lvbi5zdGFydHNXaXRoKCc1LicpIHx8IG1vZHVsZVZlcnNpb24uc3RhcnRzV2l0aCgnNi4nKSkpIHx8XG4gICAgICAgIGZhbHNlKTtcbn1cbi8qKlxuICogOC4yMS4wIGNoYW5nZWQgRG9jdW1lbnQudXBkYXRlT25lL2RlbGV0ZU9uZSBzbyB0aGF0IHRoZSBRdWVyeSBpcyBub3QgZnVsbHkgYnVpbHQgd2hlbiBRdWVyeS5leGVjKCkgaXMgY2FsbGVkLlxuICogQHBhcmFtIG1vZHVsZVZlcnNpb25cbiAqL1xuZnVuY3Rpb24gbmVlZHNEb2N1bWVudE1ldGhvZFBhdGNoKG1vZHVsZVZlcnNpb24pIHtcbiAgICBpZiAoIW1vZHVsZVZlcnNpb24gfHwgIW1vZHVsZVZlcnNpb24uc3RhcnRzV2l0aCgnOC4nKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IG1pbm9yID0gcGFyc2VJbnQobW9kdWxlVmVyc2lvbi5zcGxpdCgnLicpWzFdLCAxMCk7XG4gICAgcmV0dXJuIG1pbm9yID49IDIxO1xufVxuLy8gd2hlbiBtb25nb29zZSBmdW5jdGlvbnMgYXJlIGNhbGxlZCwgd2Ugc3RvcmUgdGhlIG9yaWdpbmFsIGNhbGwgY29udGV4dFxuLy8gYW5kIHRoZW4gc2V0IGl0IGFzIHRoZSBwYXJlbnQgZm9yIHRoZSBzcGFucyBjcmVhdGVkIGJ5IFF1ZXJ5L0FnZ3JlZ2F0ZSBleGVjKClcbi8vIGNhbGxzLiB0aGlzIGJ5cGFzcyB0aGUgdW5saW5rZWQgc3BhbnMgaXNzdWUgb24gdGhlbmFibGVzIGF3YWl0IG9wZXJhdGlvbnMuXG5leHBvcnRzLl9TVE9SRURfUEFSRU5UX1NQQU4gPSBTeW1ib2woJ3N0b3JlZC1wYXJlbnQtc3BhbicpO1xuLy8gUHJldmVudHMgZG91YmxlLWluc3RydW1lbnRhdGlvbiB3aGVuIGRvYy51cGRhdGVPbmUvZGVsZXRlT25lIChNb25nb29zZSA4LjIxLjArKVxuLy8gY3JlYXRlcyBhIHNwYW4gYW5kIHJldHVybnMgYSBRdWVyeSB0aGF0IGFsc28gY2FsbHMgZXhlYygpXG5leHBvcnRzLl9BTFJFQURZX0lOU1RSVU1FTlRFRCA9IFN5bWJvbCgnYWxyZWFkeS1pbnN0cnVtZW50ZWQnKTtcbmNsYXNzIE1vbmdvb3NlSW5zdHJ1bWVudGF0aW9uIGV4dGVuZHMgaW5zdHJ1bWVudGF0aW9uXzEuSW5zdHJ1bWVudGF0aW9uQmFzZSB7XG4gICAgX25ldFNlbWNvbnZTdGFiaWxpdHk7XG4gICAgX2RiU2VtY29udlN0YWJpbGl0eTtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcgPSB7fSkge1xuICAgICAgICBzdXBlcih2ZXJzaW9uXzEuUEFDS0FHRV9OQU1FLCB2ZXJzaW9uXzEuUEFDS0FHRV9WRVJTSU9OLCBjb25maWcpO1xuICAgICAgICB0aGlzLl9zZXRTZW1jb252U3RhYmlsaXR5RnJvbUVudigpO1xuICAgIH1cbiAgICAvLyBVc2VkIGZvciB0ZXN0aW5nLlxuICAgIF9zZXRTZW1jb252U3RhYmlsaXR5RnJvbUVudigpIHtcbiAgICAgICAgdGhpcy5fbmV0U2VtY29udlN0YWJpbGl0eSA9ICgwLCBpbnN0cnVtZW50YXRpb25fMS5zZW1jb252U3RhYmlsaXR5RnJvbVN0cikoJ2h0dHAnLCBwcm9jZXNzLmVudi5PVEVMX1NFTUNPTlZfU1RBQklMSVRZX09QVF9JTik7XG4gICAgICAgIHRoaXMuX2RiU2VtY29udlN0YWJpbGl0eSA9ICgwLCBpbnN0cnVtZW50YXRpb25fMS5zZW1jb252U3RhYmlsaXR5RnJvbVN0cikoJ2RhdGFiYXNlJywgcHJvY2Vzcy5lbnYuT1RFTF9TRU1DT05WX1NUQUJJTElUWV9PUFRfSU4pO1xuICAgIH1cbiAgICBpbml0KCkge1xuICAgICAgICBjb25zdCBtb2R1bGUgPSBuZXcgaW5zdHJ1bWVudGF0aW9uXzEuSW5zdHJ1bWVudGF0aW9uTm9kZU1vZHVsZURlZmluaXRpb24oJ21vbmdvb3NlJywgWyc+PTUuOS43IDw5J10sIHRoaXMucGF0Y2guYmluZCh0aGlzKSwgdGhpcy51bnBhdGNoLmJpbmQodGhpcykpO1xuICAgICAgICByZXR1cm4gbW9kdWxlO1xuICAgIH1cbiAgICBwYXRjaChtb2R1bGUsIG1vZHVsZVZlcnNpb24pIHtcbiAgICAgICAgY29uc3QgbW9kdWxlRXhwb3J0cyA9IG1vZHVsZVtTeW1ib2wudG9TdHJpbmdUYWddID09PSAnTW9kdWxlJ1xuICAgICAgICAgICAgPyBtb2R1bGUuZGVmYXVsdCAvLyBFU01cbiAgICAgICAgICAgIDogbW9kdWxlOyAvLyBDb21tb25KU1xuICAgICAgICB0aGlzLl93cmFwKG1vZHVsZUV4cG9ydHMuTW9kZWwucHJvdG90eXBlLCAnc2F2ZScsIHRoaXMucGF0Y2hPbk1vZGVsTWV0aG9kcygnc2F2ZScsIG1vZHVsZVZlcnNpb24pKTtcbiAgICAgICAgLy8gbW9uZ29vc2UgYXBwbGllcyB0aGlzIGNvZGUgb24gbW9kdWxlIHJlcXVpcmU6XG4gICAgICAgIC8vIE1vZGVsLnByb3RvdHlwZS4kc2F2ZSA9IE1vZGVsLnByb3RvdHlwZS5zYXZlO1xuICAgICAgICAvLyB3aGljaCBjYXB0dXJlcyB0aGUgc2F2ZSBmdW5jdGlvbiBiZWZvcmUgaXQgaXMgcGF0Y2hlZC5cbiAgICAgICAgLy8gc28gd2UgbmVlZCB0byBhcHBseSB0aGUgc2FtZSBsb2dpYyBhZnRlciBpbnN0cnVtZW50aW5nIHRoZSBzYXZlIGZ1bmN0aW9uLlxuICAgICAgICBtb2R1bGVFeHBvcnRzLk1vZGVsLnByb3RvdHlwZS4kc2F2ZSA9IG1vZHVsZUV4cG9ydHMuTW9kZWwucHJvdG90eXBlLnNhdmU7XG4gICAgICAgIGlmIChpbnN0cnVtZW50UmVtb3ZlKG1vZHVsZVZlcnNpb24pKSB7XG4gICAgICAgICAgICB0aGlzLl93cmFwKG1vZHVsZUV4cG9ydHMuTW9kZWwucHJvdG90eXBlLCAncmVtb3ZlJywgdGhpcy5wYXRjaE9uTW9kZWxNZXRob2RzKCdyZW1vdmUnLCBtb2R1bGVWZXJzaW9uKSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTW9uZ29vc2UgOC4yMS4wKyBjaGFuZ2VkIERvY3VtZW50LnVwZGF0ZU9uZSgpL2RlbGV0ZU9uZSgpIHNvIHRoYXQgdGhlIFF1ZXJ5IGlzIG5vdCBmdWxseSBidWlsdCB3aGVuIFF1ZXJ5LmV4ZWMoKSBpcyBjYWxsZWQuXG4gICAgICAgIC8vXG4gICAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vQXV0b21hdHRpYy9tb25nb29zZS9ibG9iLzdkYmRhMTJkY2ExYmQ3YWRiOWUyNzBkN2RlOGFjNTIyOTYwNmNlNzIvbGliL2RvY3VtZW50LmpzI0w4NjEuXG4gICAgICAgIC8vIC0gYHRoaXNgIGlzIGEgUXVlcnkgb2JqZWN0XG4gICAgICAgIC8vIC0gdGhlIHVwZGF0ZSBoYXBwZW5zIGluIGEgcHJlLWhvb2sgdGhhdCBnZXRzIGNhbGxlZCB3aGVuIFF1ZXJ5LmV4ZWMoKSBpcyBhbHJlYWR5IHJ1bm5pbmcuXG4gICAgICAgIC8vIC0gd2hlbiB3ZSBpbnN0cnVtZW50IFF1ZXJ5LmV4ZWMoKSwgd2UgZG9uJ3QgaGF2ZSBhY2Nlc3MgdG8gdGhlIG9wdGlvbnMgeWV0IGFzIHRoZXkgZ2V0IHNldCBkdXJpbmcgUXVlcnkuZXhlYygpIG9ubHkuXG4gICAgICAgIC8vXG4gICAgICAgIC8vIFVuZm9ydHVuYXRlbHksIGFmdGVyIFF1ZXJ5LmV4ZWMoKSBpcyBmaW5pc2hlZCwgdGhlIG9wdGlvbnMgYXJlIGxlZnQgbW9kaWZpZWQgYnkgdGhlIGxpYnJhcnksIHNvIGp1c3QgZGVsYXlpbmdcbiAgICAgICAgLy8gYXR0YWNoaW5nIHRoZSBhdHRyaWJ1dGVzIGFmdGVyIHRoZSBzcGFuIGlzIGRvbmUgaXMgbm90IGFuIG9wdGlvbi4gVGhlcmVmb3JlLCB3ZSBwYXRjaCBNb2RlbCBtZXRob2RzXG4gICAgICAgIC8vIGFuZCBncmFiIHRoZSBkYXRhIGRpcmVjdGx5IHdoZXJlIHRoZSB1c2VyIHByb3ZpZGVzIGl0LlxuICAgICAgICAvL1xuICAgICAgICAvLyByZWY6IGh0dHBzOi8vZ2l0aHViLmNvbS9BdXRvbWF0dGljL21vbmdvb3NlL3B1bGwvMTU5MDggKGludHJvZHVjZWQgdGhpcyBiZWhhdmlvcilcbiAgICAgICAgaWYgKG5lZWRzRG9jdW1lbnRNZXRob2RQYXRjaChtb2R1bGVWZXJzaW9uKSkge1xuICAgICAgICAgICAgdGhpcy5fd3JhcChtb2R1bGVFeHBvcnRzLk1vZGVsLnByb3RvdHlwZSwgJ3VwZGF0ZU9uZScsIHRoaXMuX3BhdGNoRG9jdW1lbnRVcGRhdGVNZXRob2RzKCd1cGRhdGVPbmUnLCBtb2R1bGVWZXJzaW9uKSk7XG4gICAgICAgICAgICB0aGlzLl93cmFwKG1vZHVsZUV4cG9ydHMuTW9kZWwucHJvdG90eXBlLCAnZGVsZXRlT25lJywgdGhpcy5fcGF0Y2hEb2N1bWVudFVwZGF0ZU1ldGhvZHMoJ2RlbGV0ZU9uZScsIG1vZHVsZVZlcnNpb24pKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl93cmFwKG1vZHVsZUV4cG9ydHMuUXVlcnkucHJvdG90eXBlLCAnZXhlYycsIHRoaXMucGF0Y2hRdWVyeUV4ZWMobW9kdWxlVmVyc2lvbikpO1xuICAgICAgICB0aGlzLl93cmFwKG1vZHVsZUV4cG9ydHMuQWdncmVnYXRlLnByb3RvdHlwZSwgJ2V4ZWMnLCB0aGlzLnBhdGNoQWdncmVnYXRlRXhlYyhtb2R1bGVWZXJzaW9uKSk7XG4gICAgICAgIGNvbnN0IGNvbnRleHRDYXB0dXJlRnVuY3Rpb25zID0gZ2V0Q29udGV4dENhcHR1cmVGdW5jdGlvbnMobW9kdWxlVmVyc2lvbik7XG4gICAgICAgIGNvbnRleHRDYXB0dXJlRnVuY3Rpb25zLmZvckVhY2goKGZ1bmNOYW1lKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl93cmFwKG1vZHVsZUV4cG9ydHMuUXVlcnkucHJvdG90eXBlLCBmdW5jTmFtZSwgdGhpcy5wYXRjaEFuZENhcHR1cmVTcGFuQ29udGV4dChmdW5jTmFtZSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fd3JhcChtb2R1bGVFeHBvcnRzLk1vZGVsLCAnYWdncmVnYXRlJywgdGhpcy5wYXRjaE1vZGVsQWdncmVnYXRlKCkpO1xuICAgICAgICB0aGlzLl93cmFwKG1vZHVsZUV4cG9ydHMuTW9kZWwsICdpbnNlcnRNYW55JywgdGhpcy5wYXRjaE1vZGVsU3RhdGljKCdpbnNlcnRNYW55JywgbW9kdWxlVmVyc2lvbikpO1xuICAgICAgICB0aGlzLl93cmFwKG1vZHVsZUV4cG9ydHMuTW9kZWwsICdidWxrV3JpdGUnLCB0aGlzLnBhdGNoTW9kZWxTdGF0aWMoJ2J1bGtXcml0ZScsIG1vZHVsZVZlcnNpb24pKTtcbiAgICAgICAgcmV0dXJuIG1vZHVsZUV4cG9ydHM7XG4gICAgfVxuICAgIHVucGF0Y2gobW9kdWxlLCBtb2R1bGVWZXJzaW9uKSB7XG4gICAgICAgIGNvbnN0IG1vZHVsZUV4cG9ydHMgPSBtb2R1bGVbU3ltYm9sLnRvU3RyaW5nVGFnXSA9PT0gJ01vZHVsZSdcbiAgICAgICAgICAgID8gbW9kdWxlLmRlZmF1bHQgLy8gRVNNXG4gICAgICAgICAgICA6IG1vZHVsZTsgLy8gQ29tbW9uSlNcbiAgICAgICAgY29uc3QgY29udGV4dENhcHR1cmVGdW5jdGlvbnMgPSBnZXRDb250ZXh0Q2FwdHVyZUZ1bmN0aW9ucyhtb2R1bGVWZXJzaW9uKTtcbiAgICAgICAgdGhpcy5fdW53cmFwKG1vZHVsZUV4cG9ydHMuTW9kZWwucHJvdG90eXBlLCAnc2F2ZScpO1xuICAgICAgICAvLyByZXZlcnQgdGhlIHBhdGNoIGZvciAkc2F2ZSB3aGljaCB3ZSBhcHBsaWVkIGJ5IGFsaWFzaW5nIGl0IHRvIHBhdGNoZWQgYHNhdmVgXG4gICAgICAgIG1vZHVsZUV4cG9ydHMuTW9kZWwucHJvdG90eXBlLiRzYXZlID0gbW9kdWxlRXhwb3J0cy5Nb2RlbC5wcm90b3R5cGUuc2F2ZTtcbiAgICAgICAgaWYgKGluc3RydW1lbnRSZW1vdmUobW9kdWxlVmVyc2lvbikpIHtcbiAgICAgICAgICAgIHRoaXMuX3Vud3JhcChtb2R1bGVFeHBvcnRzLk1vZGVsLnByb3RvdHlwZSwgJ3JlbW92ZScpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZWVkc0RvY3VtZW50TWV0aG9kUGF0Y2gobW9kdWxlVmVyc2lvbikpIHtcbiAgICAgICAgICAgIHRoaXMuX3Vud3JhcChtb2R1bGVFeHBvcnRzLk1vZGVsLnByb3RvdHlwZSwgJ3VwZGF0ZU9uZScpO1xuICAgICAgICAgICAgdGhpcy5fdW53cmFwKG1vZHVsZUV4cG9ydHMuTW9kZWwucHJvdG90eXBlLCAnZGVsZXRlT25lJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdW53cmFwKG1vZHVsZUV4cG9ydHMuUXVlcnkucHJvdG90eXBlLCAnZXhlYycpO1xuICAgICAgICB0aGlzLl91bndyYXAobW9kdWxlRXhwb3J0cy5BZ2dyZWdhdGUucHJvdG90eXBlLCAnZXhlYycpO1xuICAgICAgICBjb250ZXh0Q2FwdHVyZUZ1bmN0aW9ucy5mb3JFYWNoKChmdW5jTmFtZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fdW53cmFwKG1vZHVsZUV4cG9ydHMuUXVlcnkucHJvdG90eXBlLCBmdW5jTmFtZSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl91bndyYXAobW9kdWxlRXhwb3J0cy5Nb2RlbCwgJ2FnZ3JlZ2F0ZScpO1xuICAgICAgICB0aGlzLl91bndyYXAobW9kdWxlRXhwb3J0cy5Nb2RlbCwgJ2luc2VydE1hbnknKTtcbiAgICAgICAgdGhpcy5fdW53cmFwKG1vZHVsZUV4cG9ydHMuTW9kZWwsICdidWxrV3JpdGUnKTtcbiAgICB9XG4gICAgcGF0Y2hBZ2dyZWdhdGVFeGVjKG1vZHVsZVZlcnNpb24pIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiAob3JpZ2luYWxBZ2dyZWdhdGUpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBleGVjKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuZ2V0Q29uZmlnKCkucmVxdWlyZVBhcmVudFNwYW4gJiZcbiAgICAgICAgICAgICAgICAgICAgYXBpXzEudHJhY2UuZ2V0U3BhbihhcGlfMS5jb250ZXh0LmFjdGl2ZSgpKSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbEFnZ3JlZ2F0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRTcGFuID0gdGhpc1tleHBvcnRzLl9TVE9SRURfUEFSRU5UX1NQQU5dO1xuICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB7fTtcbiAgICAgICAgICAgICAgICBjb25zdCB7IGRiU3RhdGVtZW50U2VyaWFsaXplciB9ID0gc2VsZi5nZXRDb25maWcoKTtcbiAgICAgICAgICAgICAgICBpZiAoZGJTdGF0ZW1lbnRTZXJpYWxpemVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXRlbWVudCA9IGRiU3RhdGVtZW50U2VyaWFsaXplcignYWdncmVnYXRlJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogdGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWdncmVnYXRlUGlwZWxpbmU6IHRoaXMuX3BpcGVsaW5lLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuX2RiU2VtY29udlN0YWJpbGl0eSAmIGluc3RydW1lbnRhdGlvbl8xLlNlbWNvbnZTdGFiaWxpdHkuT0xEKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzW3NlbWNvbnZfMS5BVFRSX0RCX1NUQVRFTUVOVF0gPSBzdGF0ZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuX2RiU2VtY29udlN0YWJpbGl0eSAmIGluc3RydW1lbnRhdGlvbl8xLlNlbWNvbnZTdGFiaWxpdHkuU1RBQkxFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzW3NlbWFudGljX2NvbnZlbnRpb25zXzEuQVRUUl9EQl9RVUVSWV9URVhUXSA9IHN0YXRlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBzcGFuID0gc2VsZi5fc3RhcnRTcGFuKHRoaXMuX21vZGVsLmNvbGxlY3Rpb24sIHRoaXMuX21vZGVsPy5tb2RlbE5hbWUsICdhZ2dyZWdhdGUnLCBhdHRyaWJ1dGVzLCBwYXJlbnRTcGFuKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5faGFuZGxlUmVzcG9uc2Uoc3Bhbiwgb3JpZ2luYWxBZ2dyZWdhdGUsIHRoaXMsIGFyZ3VtZW50cywgY2FsbGJhY2ssIG1vZHVsZVZlcnNpb24pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcGF0Y2hRdWVyeUV4ZWMobW9kdWxlVmVyc2lvbikge1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcbiAgICAgICAgcmV0dXJuIChvcmlnaW5hbEV4ZWMpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBleGVjKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgLy8gU2tpcCBpZiBhbHJlYWR5IGluc3RydW1lbnRlZCBieSBkb2N1bWVudCBpbnN0YW5jZSBtZXRob2QgcGF0Y2hcbiAgICAgICAgICAgICAgICBpZiAodGhpc1tleHBvcnRzLl9BTFJFQURZX0lOU1RSVU1FTlRFRF0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsRXhlYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5nZXRDb25maWcoKS5yZXF1aXJlUGFyZW50U3BhbiAmJlxuICAgICAgICAgICAgICAgICAgICBhcGlfMS50cmFjZS5nZXRTcGFuKGFwaV8xLmNvbnRleHQuYWN0aXZlKCkpID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsRXhlYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRTcGFuID0gdGhpc1tleHBvcnRzLl9TVE9SRURfUEFSRU5UX1NQQU5dO1xuICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB7fTtcbiAgICAgICAgICAgICAgICBjb25zdCB7IGRiU3RhdGVtZW50U2VyaWFsaXplciB9ID0gc2VsZi5nZXRDb25maWcoKTtcbiAgICAgICAgICAgICAgICBpZiAoZGJTdGF0ZW1lbnRTZXJpYWxpemVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXRlbWVudCA9IGRiU3RhdGVtZW50U2VyaWFsaXplcih0aGlzLm9wLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVc2UgcHVibGljIEFQSSBtZXRob2RzIChnZXRGaWx0ZXIvZ2V0T3B0aW9ucykgZm9yIGJldHRlciBjb21wYXRpYmlsaXR5XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25kaXRpb246IHRoaXMuZ2V0RmlsdGVyPy4oKSA/PyB0aGlzLl9jb25kaXRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlczogdGhpcy5fdXBkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogdGhpcy5nZXRPcHRpb25zPy4oKSA/PyB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHM6IHRoaXMuX2ZpZWxkcyxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLl9kYlNlbWNvbnZTdGFiaWxpdHkgJiBpbnN0cnVtZW50YXRpb25fMS5TZW1jb252U3RhYmlsaXR5Lk9MRCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlc1tzZW1jb252XzEuQVRUUl9EQl9TVEFURU1FTlRdID0gc3RhdGVtZW50O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLl9kYlNlbWNvbnZTdGFiaWxpdHkgJiBpbnN0cnVtZW50YXRpb25fMS5TZW1jb252U3RhYmlsaXR5LlNUQUJMRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlc1tzZW1hbnRpY19jb252ZW50aW9uc18xLkFUVFJfREJfUVVFUllfVEVYVF0gPSBzdGF0ZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgc3BhbiA9IHNlbGYuX3N0YXJ0U3Bhbih0aGlzLm1vbmdvb3NlQ29sbGVjdGlvbiwgdGhpcy5tb2RlbC5tb2RlbE5hbWUsIHRoaXMub3AsIGF0dHJpYnV0ZXMsIHBhcmVudFNwYW4pO1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLl9oYW5kbGVSZXNwb25zZShzcGFuLCBvcmlnaW5hbEV4ZWMsIHRoaXMsIGFyZ3VtZW50cywgY2FsbGJhY2ssIG1vZHVsZVZlcnNpb24pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcGF0Y2hPbk1vZGVsTWV0aG9kcyhvcCwgbW9kdWxlVmVyc2lvbikge1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcbiAgICAgICAgcmV0dXJuIChvcmlnaW5hbE9uTW9kZWxGdW5jdGlvbikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG1ldGhvZChvcHRpb25zLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmdldENvbmZpZygpLnJlcXVpcmVQYXJlbnRTcGFuICYmXG4gICAgICAgICAgICAgICAgICAgIGFwaV8xLnRyYWNlLmdldFNwYW4oYXBpXzEuY29udGV4dC5hY3RpdmUoKSkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3JpZ2luYWxPbk1vZGVsRnVuY3Rpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VyaWFsaXplUGF5bG9hZCA9IHsgZG9jdW1lbnQ6IHRoaXMgfTtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyAmJiAhKG9wdGlvbnMgaW5zdGFuY2VvZiBGdW5jdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VyaWFsaXplUGF5bG9hZC5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHt9O1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgZGJTdGF0ZW1lbnRTZXJpYWxpemVyIH0gPSBzZWxmLmdldENvbmZpZygpO1xuICAgICAgICAgICAgICAgIGlmIChkYlN0YXRlbWVudFNlcmlhbGl6ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhdGVtZW50ID0gZGJTdGF0ZW1lbnRTZXJpYWxpemVyKG9wLCBzZXJpYWxpemVQYXlsb2FkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuX2RiU2VtY29udlN0YWJpbGl0eSAmIGluc3RydW1lbnRhdGlvbl8xLlNlbWNvbnZTdGFiaWxpdHkuT0xEKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzW3NlbWNvbnZfMS5BVFRSX0RCX1NUQVRFTUVOVF0gPSBzdGF0ZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuX2RiU2VtY29udlN0YWJpbGl0eSAmIGluc3RydW1lbnRhdGlvbl8xLlNlbWNvbnZTdGFiaWxpdHkuU1RBQkxFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzW3NlbWFudGljX2NvbnZlbnRpb25zXzEuQVRUUl9EQl9RVUVSWV9URVhUXSA9IHN0YXRlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBzcGFuID0gc2VsZi5fc3RhcnRTcGFuKHRoaXMuY29uc3RydWN0b3IuY29sbGVjdGlvbiwgdGhpcy5jb25zdHJ1Y3Rvci5tb2RlbE5hbWUsIG9wLCBhdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrID0gb3B0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2hhbmRsZVJlc3BvbnNlKHNwYW4sIG9yaWdpbmFsT25Nb2RlbEZ1bmN0aW9uLCB0aGlzLCBhcmd1bWVudHMsIGNhbGxiYWNrLCBtb2R1bGVWZXJzaW9uKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgfVxuICAgIC8vIFBhdGNoIGRvY3VtZW50IGluc3RhbmNlIG1ldGhvZHMgKGRvYy51cGRhdGVPbmUvZGVsZXRlT25lKSBmb3IgTW9uZ29vc2UgOC4yMS4wKy5cbiAgICBfcGF0Y2hEb2N1bWVudFVwZGF0ZU1ldGhvZHMob3AsIG1vZHVsZVZlcnNpb24pIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiAob3JpZ2luYWxNZXRob2QpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBtZXRob2QodXBkYXRlLCBvcHRpb25zLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmdldENvbmZpZygpLnJlcXVpcmVQYXJlbnRTcGFuICYmXG4gICAgICAgICAgICAgICAgICAgIGFwaV8xLnRyYWNlLmdldFNwYW4oYXBpXzEuY29udGV4dC5hY3RpdmUoKSkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3JpZ2luYWxNZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gZGV0ZXJtaW5lIGFjdHVhbCBjYWxsYmFjayBzaW5jZSBkaWZmZXJlbnQgYXJndW1lbnQgcGF0dGVybnMgYXJlIGFsbG93ZWRcbiAgICAgICAgICAgICAgICBsZXQgYWN0dWFsQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICAgICAgICAgICAgICBsZXQgYWN0dWFsVXBkYXRlID0gdXBkYXRlO1xuICAgICAgICAgICAgICAgIGxldCBhY3R1YWxPcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHVwZGF0ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBhY3R1YWxDYWxsYmFjayA9IHVwZGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgYWN0dWFsVXBkYXRlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICBhY3R1YWxPcHRpb25zID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBhY3R1YWxDYWxsYmFjayA9IG9wdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgIGFjdHVhbE9wdGlvbnMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB7fTtcbiAgICAgICAgICAgICAgICBjb25zdCBkYlN0YXRlbWVudFNlcmlhbGl6ZXIgPSBzZWxmLmdldENvbmZpZygpLmRiU3RhdGVtZW50U2VyaWFsaXplcjtcbiAgICAgICAgICAgICAgICBpZiAoZGJTdGF0ZW1lbnRTZXJpYWxpemVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXRlbWVudCA9IGRiU3RhdGVtZW50U2VyaWFsaXplcihvcCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG9jdW1lbnQgaW5zdGFuY2UgbWV0aG9kcyBhdXRvbWF0aWNhbGx5IHVzZSB0aGUgZG9jdW1lbnQncyBfaWQgYXMgZmlsdGVyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25kaXRpb246IHsgX2lkOiB0aGlzLl9pZCB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlczogYWN0dWFsVXBkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogYWN0dWFsT3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLl9kYlNlbWNvbnZTdGFiaWxpdHkgJiBpbnN0cnVtZW50YXRpb25fMS5TZW1jb252U3RhYmlsaXR5Lk9MRCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlc1tzZW1jb252XzEuQVRUUl9EQl9TVEFURU1FTlRdID0gc3RhdGVtZW50O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLl9kYlNlbWNvbnZTdGFiaWxpdHkgJiBpbnN0cnVtZW50YXRpb25fMS5TZW1jb252U3RhYmlsaXR5LlNUQUJMRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlc1tzZW1hbnRpY19jb252ZW50aW9uc18xLkFUVFJfREJfUVVFUllfVEVYVF0gPSBzdGF0ZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgc3BhbiA9IHNlbGYuX3N0YXJ0U3Bhbih0aGlzLmNvbnN0cnVjdG9yLmNvbGxlY3Rpb24sIHRoaXMuY29uc3RydWN0b3IubW9kZWxOYW1lLCBvcCwgYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc2VsZi5faGFuZGxlUmVzcG9uc2Uoc3Bhbiwgb3JpZ2luYWxNZXRob2QsIHRoaXMsIGFyZ3VtZW50cywgYWN0dWFsQ2FsbGJhY2ssIG1vZHVsZVZlcnNpb24pO1xuICAgICAgICAgICAgICAgIC8vIE1hcmsgcmV0dXJuZWQgUXVlcnkgdG8gcHJldmVudCBkb3VibGUtaW5zdHJ1bWVudGF0aW9uIHdoZW4gZXhlYygpIGlzIGV2ZW50dWFsbHkgY2FsbGVkXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAmJiB0eXBlb2YgcmVzdWx0ID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRbZXhwb3J0cy5fQUxSRUFEWV9JTlNUUlVNRU5URURdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgfVxuICAgIHBhdGNoTW9kZWxTdGF0aWMob3AsIG1vZHVsZVZlcnNpb24pIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiAob3JpZ2luYWwpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBwYXRjaGVkU3RhdGljKGRvY3NPck9wcywgb3B0aW9ucywgY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5nZXRDb25maWcoKS5yZXF1aXJlUGFyZW50U3BhbiAmJlxuICAgICAgICAgICAgICAgICAgICBhcGlfMS50cmFjZS5nZXRTcGFuKGFwaV8xLmNvbnRleHQuYWN0aXZlKCkpID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayA9IG9wdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHNlcmlhbGl6ZVBheWxvYWQgPSB7fTtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2luc2VydE1hbnknOlxuICAgICAgICAgICAgICAgICAgICAgICAgc2VyaWFsaXplUGF5bG9hZC5kb2N1bWVudHMgPSBkb2NzT3JPcHM7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVsa1dyaXRlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcmlhbGl6ZVBheWxvYWQub3BlcmF0aW9ucyA9IGRvY3NPck9wcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgc2VyaWFsaXplUGF5bG9hZC5kb2N1bWVudCA9IGRvY3NPck9wcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlcmlhbGl6ZVBheWxvYWQub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB7fTtcbiAgICAgICAgICAgICAgICBjb25zdCB7IGRiU3RhdGVtZW50U2VyaWFsaXplciB9ID0gc2VsZi5nZXRDb25maWcoKTtcbiAgICAgICAgICAgICAgICBpZiAoZGJTdGF0ZW1lbnRTZXJpYWxpemVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXRlbWVudCA9IGRiU3RhdGVtZW50U2VyaWFsaXplcihvcCwgc2VyaWFsaXplUGF5bG9hZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLl9kYlNlbWNvbnZTdGFiaWxpdHkgJiBpbnN0cnVtZW50YXRpb25fMS5TZW1jb252U3RhYmlsaXR5Lk9MRCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlc1tzZW1jb252XzEuQVRUUl9EQl9TVEFURU1FTlRdID0gc3RhdGVtZW50O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLl9kYlNlbWNvbnZTdGFiaWxpdHkgJiBpbnN0cnVtZW50YXRpb25fMS5TZW1jb252U3RhYmlsaXR5LlNUQUJMRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlc1tzZW1hbnRpY19jb252ZW50aW9uc18xLkFUVFJfREJfUVVFUllfVEVYVF0gPSBzdGF0ZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgc3BhbiA9IHNlbGYuX3N0YXJ0U3Bhbih0aGlzLmNvbGxlY3Rpb24sIHRoaXMubW9kZWxOYW1lLCBvcCwgYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2hhbmRsZVJlc3BvbnNlKHNwYW4sIG9yaWdpbmFsLCB0aGlzLCBhcmd1bWVudHMsIGNhbGxiYWNrLCBtb2R1bGVWZXJzaW9uKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgfVxuICAgIC8vIHdlIHdhbnQgdG8gY2FwdHVyZSB0aGUgb3RlbCBzcGFuIG9uIHRoZSBvYmplY3Qgd2hpY2ggaXMgY2FsbGluZyBleGVjLlxuICAgIC8vIGluIHRoZSBzcGVjaWFsIGNhc2Ugb2YgYWdncmVnYXRlLCB3ZSBuZWVkIGhhdmUgbm8gZnVuY3Rpb24gdG8gcGF0aFxuICAgIC8vIG9uIHRoZSBBZ2dyZWdhdGUgb2JqZWN0IHRvIGNhcHR1cmUgdGhlIGNvbnRleHQgb24sIHNvIHdlIHBhdGNoXG4gICAgLy8gdGhlIGFnZ3JlZ2F0ZSBvZiBNb2RlbCwgYW5kIHNldCB0aGUgY29udGV4dCBvbiB0aGUgQWdncmVnYXRlIG9iamVjdFxuICAgIHBhdGNoTW9kZWxBZ2dyZWdhdGUoKSB7XG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuICAgICAgICByZXR1cm4gKG9yaWdpbmFsKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gY2FwdHVyZVNwYW5Db250ZXh0KCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRTcGFuID0gYXBpXzEudHJhY2UuZ2V0U3BhbihhcGlfMS5jb250ZXh0LmFjdGl2ZSgpKTtcbiAgICAgICAgICAgICAgICBjb25zdCBhZ2dyZWdhdGUgPSBzZWxmLl9jYWxsT3JpZ2luYWxGdW5jdGlvbigoKSA9PiBvcmlnaW5hbC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICAgICAgICAgICAgICBpZiAoYWdncmVnYXRlKVxuICAgICAgICAgICAgICAgICAgICBhZ2dyZWdhdGVbZXhwb3J0cy5fU1RPUkVEX1BBUkVOVF9TUEFOXSA9IGN1cnJlbnRTcGFuO1xuICAgICAgICAgICAgICAgIHJldHVybiBhZ2dyZWdhdGU7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgIH1cbiAgICBwYXRjaEFuZENhcHR1cmVTcGFuQ29udGV4dChmdW5jTmFtZSkge1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcbiAgICAgICAgcmV0dXJuIChvcmlnaW5hbCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGNhcHR1cmVTcGFuQ29udGV4dCgpIHtcbiAgICAgICAgICAgICAgICB0aGlzW2V4cG9ydHMuX1NUT1JFRF9QQVJFTlRfU1BBTl0gPSBhcGlfMS50cmFjZS5nZXRTcGFuKGFwaV8xLmNvbnRleHQuYWN0aXZlKCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLl9jYWxsT3JpZ2luYWxGdW5jdGlvbigoKSA9PiBvcmlnaW5hbC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgfVxuICAgIF9zdGFydFNwYW4oY29sbGVjdGlvbiwgbW9kZWxOYW1lLCBvcGVyYXRpb24sIGF0dHJpYnV0ZXMsIHBhcmVudFNwYW4pIHtcbiAgICAgICAgY29uc3QgZmluYWxBdHRyaWJ1dGVzID0ge1xuICAgICAgICAgICAgLi4uYXR0cmlidXRlcyxcbiAgICAgICAgICAgIC4uLigwLCB1dGlsc18xLmdldEF0dHJpYnV0ZXNGcm9tQ29sbGVjdGlvbikoY29sbGVjdGlvbiwgdGhpcy5fZGJTZW1jb252U3RhYmlsaXR5LCB0aGlzLl9uZXRTZW1jb252U3RhYmlsaXR5KSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuX2RiU2VtY29udlN0YWJpbGl0eSAmIGluc3RydW1lbnRhdGlvbl8xLlNlbWNvbnZTdGFiaWxpdHkuT0xEKSB7XG4gICAgICAgICAgICBmaW5hbEF0dHJpYnV0ZXNbc2VtY29udl8xLkFUVFJfREJfT1BFUkFUSU9OXSA9IG9wZXJhdGlvbjtcbiAgICAgICAgICAgIGZpbmFsQXR0cmlidXRlc1tzZW1jb252XzEuQVRUUl9EQl9TWVNURU1dID0gJ21vbmdvb3NlJzsgLy8ga2VlcCBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHlcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fZGJTZW1jb252U3RhYmlsaXR5ICYgaW5zdHJ1bWVudGF0aW9uXzEuU2VtY29udlN0YWJpbGl0eS5TVEFCTEUpIHtcbiAgICAgICAgICAgIGZpbmFsQXR0cmlidXRlc1tzZW1hbnRpY19jb252ZW50aW9uc18xLkFUVFJfREJfT1BFUkFUSU9OX05BTUVdID0gb3BlcmF0aW9uO1xuICAgICAgICAgICAgZmluYWxBdHRyaWJ1dGVzW3NlbWFudGljX2NvbnZlbnRpb25zXzEuQVRUUl9EQl9TWVNURU1fTkFNRV0gPSBzZW1jb252XzEuREJfU1lTVEVNX05BTUVfVkFMVUVfTU9OR09EQjsgLy8gYWN0dWFsIGRiIHN5c3RlbSBuYW1lXG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3Bhbk5hbWUgPSB0aGlzLl9kYlNlbWNvbnZTdGFiaWxpdHkgJiBpbnN0cnVtZW50YXRpb25fMS5TZW1jb252U3RhYmlsaXR5LlNUQUJMRVxuICAgICAgICAgICAgPyBgJHtvcGVyYXRpb259ICR7Y29sbGVjdGlvbi5uYW1lfWBcbiAgICAgICAgICAgIDogYG1vbmdvb3NlLiR7bW9kZWxOYW1lfS4ke29wZXJhdGlvbn1gO1xuICAgICAgICByZXR1cm4gdGhpcy50cmFjZXIuc3RhcnRTcGFuKHNwYW5OYW1lLCB7XG4gICAgICAgICAgICBraW5kOiBhcGlfMS5TcGFuS2luZC5DTElFTlQsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiBmaW5hbEF0dHJpYnV0ZXMsXG4gICAgICAgIH0sIHBhcmVudFNwYW4gPyBhcGlfMS50cmFjZS5zZXRTcGFuKGFwaV8xLmNvbnRleHQuYWN0aXZlKCksIHBhcmVudFNwYW4pIDogdW5kZWZpbmVkKTtcbiAgICB9XG4gICAgX2hhbmRsZVJlc3BvbnNlKHNwYW4sIGV4ZWMsIG9yaWdpbmFsVGhpcywgYXJncywgY2FsbGJhY2ssIG1vZHVsZVZlcnNpb24gPSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICAgIGlmIChjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gc2VsZi5fY2FsbE9yaWdpbmFsRnVuY3Rpb24oKCkgPT4gKDAsIHV0aWxzXzEuaGFuZGxlQ2FsbGJhY2tSZXNwb25zZSkoY2FsbGJhY2ssIGV4ZWMsIG9yaWdpbmFsVGhpcywgc3BhbiwgYXJncywgc2VsZi5nZXRDb25maWcoKS5yZXNwb25zZUhvb2ssIG1vZHVsZVZlcnNpb24pKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gc2VsZi5fY2FsbE9yaWdpbmFsRnVuY3Rpb24oKCkgPT4gZXhlYy5hcHBseShvcmlnaW5hbFRoaXMsIGFyZ3MpKTtcbiAgICAgICAgICAgIHJldHVybiAoMCwgdXRpbHNfMS5oYW5kbGVQcm9taXNlUmVzcG9uc2UpKHJlc3BvbnNlLCBzcGFuLCBzZWxmLmdldENvbmZpZygpLnJlc3BvbnNlSG9vaywgbW9kdWxlVmVyc2lvbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2NhbGxPcmlnaW5hbEZ1bmN0aW9uKG9yaWdpbmFsRnVuY3Rpb24pIHtcbiAgICAgICAgaWYgKHRoaXMuZ2V0Q29uZmlnKCkuc3VwcHJlc3NJbnRlcm5hbEluc3RydW1lbnRhdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIGFwaV8xLmNvbnRleHQud2l0aCgoMCwgY29yZV8xLnN1cHByZXNzVHJhY2luZykoYXBpXzEuY29udGV4dC5hY3RpdmUoKSksIG9yaWdpbmFsRnVuY3Rpb24pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsRnVuY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMuTW9uZ29vc2VJbnN0cnVtZW50YXRpb24gPSBNb25nb29zZUluc3RydW1lbnRhdGlvbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vbmdvb3NlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/mongoose.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/semconv.js":
/*!******************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/semconv.js ***!
  \******************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\n/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.DB_SYSTEM_NAME_VALUE_MONGODB = exports.ATTR_NET_PEER_PORT = exports.ATTR_NET_PEER_NAME = exports.ATTR_DB_USER = exports.ATTR_DB_SYSTEM = exports.ATTR_DB_STATEMENT = exports.ATTR_DB_OPERATION = exports.ATTR_DB_NAME = exports.ATTR_DB_MONGODB_COLLECTION = void 0;\n/*\n * This file contains a copy of unstable semantic convention definitions\n * used by this package.\n * @see https://github.com/open-telemetry/opentelemetry-js/tree/main/semantic-conventions#unstable-semconv\n */\n/**\n * Deprecated, use `db.collection.name` instead.\n *\n * @example \"mytable\"\n *\n * @experimental This attribute is experimental and is subject to breaking changes in minor releases of `@opentelemetry/semantic-conventions`.\n *\n * @deprecated Replaced by `db.collection.name`.\n */\nexports.ATTR_DB_MONGODB_COLLECTION = 'db.mongodb.collection';\n/**\n * Deprecated, use `db.namespace` instead.\n *\n * @example customers\n * @example main\n *\n * @experimental This attribute is experimental and is subject to breaking changes in minor releases of `@opentelemetry/semantic-conventions`.\n *\n * @deprecated Replaced by `db.namespace`.\n */\nexports.ATTR_DB_NAME = 'db.name';\n/**\n * Deprecated, use `db.operation.name` instead.\n *\n * @example findAndModify\n * @example HMSET\n * @example SELECT\n *\n * @experimental This attribute is experimental and is subject to breaking changes in minor releases of `@opentelemetry/semantic-conventions`.\n *\n * @deprecated Replaced by `db.operation.name`.\n */\nexports.ATTR_DB_OPERATION = 'db.operation';\n/**\n * The database statement being executed.\n *\n * @example SELECT * FROM wuser_table\n * @example SET mykey \"WuValue\"\n *\n * @experimental This attribute is experimental and is subject to breaking changes in minor releases of `@opentelemetry/semantic-conventions`.\n *\n * @deprecated Replaced by `db.query.text`.\n */\nexports.ATTR_DB_STATEMENT = 'db.statement';\n/**\n * Deprecated, use `db.system.name` instead.\n *\n * @experimental This attribute is experimental and is subject to breaking changes in minor releases of `@opentelemetry/semantic-conventions`.\n *\n * @deprecated Replaced by `db.system.name`.\n */\nexports.ATTR_DB_SYSTEM = 'db.system';\n/**\n * Deprecated, no replacement at this time.\n *\n * @example readonly_user\n * @example reporting_user\n *\n * @experimental This attribute is experimental and is subject to breaking changes in minor releases of `@opentelemetry/semantic-conventions`.\n *\n * @deprecated Removed, no replacement at this time.\n */\nexports.ATTR_DB_USER = 'db.user';\n/**\n * Deprecated, use `server.address` on client spans and `client.address` on server spans.\n *\n * @example example.com\n *\n * @experimental This attribute is experimental and is subject to breaking changes in minor releases of `@opentelemetry/semantic-conventions`.\n *\n * @deprecated Replaced by `server.address` on client spans and `client.address` on server spans.\n */\nexports.ATTR_NET_PEER_NAME = 'net.peer.name';\n/**\n * Deprecated, use `server.port` on client spans and `client.port` on server spans.\n *\n * @example 8080\n *\n * @experimental This attribute is experimental and is subject to breaking changes in minor releases of `@opentelemetry/semantic-conventions`.\n *\n * @deprecated Replaced by `server.port` on client spans and `client.port` on server spans.\n */\nexports.ATTR_NET_PEER_PORT = 'net.peer.port';\n/**\n * Enum value \"mongodb\" for attribute {@link ATTR_DB_SYSTEM_NAME}.\n *\n * [MongoDB](https://www.mongodb.com/)\n *\n * @experimental This enum value is experimental and is subject to breaking changes in minor releases of `@opentelemetry/semantic-conventions`.\n */\nexports.DB_SYSTEM_NAME_VALUE_MONGODB = 'mongodb';\n//# sourceMappingURL=semconv.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQG9wZW50ZWxlbWV0cnkraW5zdHJ1bWVudGF0aW9uLW1vbmdvb3NlQDAuNTcuMF9Ab3BlbnRlbGVtZXRyeSthcGlAMS45LjAvbm9kZV9tb2R1bGVzL0BvcGVudGVsZW1ldHJ5L2luc3RydW1lbnRhdGlvbi1tb25nb29zZS9idWlsZC9zcmMvc2VtY29udi5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxvQ0FBb0MsR0FBRywwQkFBMEIsR0FBRywwQkFBMEIsR0FBRyxvQkFBb0IsR0FBRyxzQkFBc0IsR0FBRyx5QkFBeUIsR0FBRyx5QkFBeUIsR0FBRyxvQkFBb0IsR0FBRyxrQ0FBa0M7QUFDbFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQSx1Q0FBdUMsMEJBQTBCO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9sZWlpbmRpYXMvLi9ub2RlX21vZHVsZXMvLnBucG0vQG9wZW50ZWxlbWV0cnkraW5zdHJ1bWVudGF0aW9uLW1vbmdvb3NlQDAuNTcuMF9Ab3BlbnRlbGVtZXRyeSthcGlAMS45LjAvbm9kZV9tb2R1bGVzL0BvcGVudGVsZW1ldHJ5L2luc3RydW1lbnRhdGlvbi1tb25nb29zZS9idWlsZC9zcmMvc2VtY29udi5qcz82MzYwIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuLypcbiAqIENvcHlyaWdodCBUaGUgT3BlblRlbGVtZXRyeSBBdXRob3JzXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cHM6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuREJfU1lTVEVNX05BTUVfVkFMVUVfTU9OR09EQiA9IGV4cG9ydHMuQVRUUl9ORVRfUEVFUl9QT1JUID0gZXhwb3J0cy5BVFRSX05FVF9QRUVSX05BTUUgPSBleHBvcnRzLkFUVFJfREJfVVNFUiA9IGV4cG9ydHMuQVRUUl9EQl9TWVNURU0gPSBleHBvcnRzLkFUVFJfREJfU1RBVEVNRU5UID0gZXhwb3J0cy5BVFRSX0RCX09QRVJBVElPTiA9IGV4cG9ydHMuQVRUUl9EQl9OQU1FID0gZXhwb3J0cy5BVFRSX0RCX01PTkdPREJfQ09MTEVDVElPTiA9IHZvaWQgMDtcbi8qXG4gKiBUaGlzIGZpbGUgY29udGFpbnMgYSBjb3B5IG9mIHVuc3RhYmxlIHNlbWFudGljIGNvbnZlbnRpb24gZGVmaW5pdGlvbnNcbiAqIHVzZWQgYnkgdGhpcyBwYWNrYWdlLlxuICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vb3Blbi10ZWxlbWV0cnkvb3BlbnRlbGVtZXRyeS1qcy90cmVlL21haW4vc2VtYW50aWMtY29udmVudGlvbnMjdW5zdGFibGUtc2VtY29udlxuICovXG4vKipcbiAqIERlcHJlY2F0ZWQsIHVzZSBgZGIuY29sbGVjdGlvbi5uYW1lYCBpbnN0ZWFkLlxuICpcbiAqIEBleGFtcGxlIFwibXl0YWJsZVwiXG4gKlxuICogQGV4cGVyaW1lbnRhbCBUaGlzIGF0dHJpYnV0ZSBpcyBleHBlcmltZW50YWwgYW5kIGlzIHN1YmplY3QgdG8gYnJlYWtpbmcgY2hhbmdlcyBpbiBtaW5vciByZWxlYXNlcyBvZiBgQG9wZW50ZWxlbWV0cnkvc2VtYW50aWMtY29udmVudGlvbnNgLlxuICpcbiAqIEBkZXByZWNhdGVkIFJlcGxhY2VkIGJ5IGBkYi5jb2xsZWN0aW9uLm5hbWVgLlxuICovXG5leHBvcnRzLkFUVFJfREJfTU9OR09EQl9DT0xMRUNUSU9OID0gJ2RiLm1vbmdvZGIuY29sbGVjdGlvbic7XG4vKipcbiAqIERlcHJlY2F0ZWQsIHVzZSBgZGIubmFtZXNwYWNlYCBpbnN0ZWFkLlxuICpcbiAqIEBleGFtcGxlIGN1c3RvbWVyc1xuICogQGV4YW1wbGUgbWFpblxuICpcbiAqIEBleHBlcmltZW50YWwgVGhpcyBhdHRyaWJ1dGUgaXMgZXhwZXJpbWVudGFsIGFuZCBpcyBzdWJqZWN0IHRvIGJyZWFraW5nIGNoYW5nZXMgaW4gbWlub3IgcmVsZWFzZXMgb2YgYEBvcGVudGVsZW1ldHJ5L3NlbWFudGljLWNvbnZlbnRpb25zYC5cbiAqXG4gKiBAZGVwcmVjYXRlZCBSZXBsYWNlZCBieSBgZGIubmFtZXNwYWNlYC5cbiAqL1xuZXhwb3J0cy5BVFRSX0RCX05BTUUgPSAnZGIubmFtZSc7XG4vKipcbiAqIERlcHJlY2F0ZWQsIHVzZSBgZGIub3BlcmF0aW9uLm5hbWVgIGluc3RlYWQuXG4gKlxuICogQGV4YW1wbGUgZmluZEFuZE1vZGlmeVxuICogQGV4YW1wbGUgSE1TRVRcbiAqIEBleGFtcGxlIFNFTEVDVFxuICpcbiAqIEBleHBlcmltZW50YWwgVGhpcyBhdHRyaWJ1dGUgaXMgZXhwZXJpbWVudGFsIGFuZCBpcyBzdWJqZWN0IHRvIGJyZWFraW5nIGNoYW5nZXMgaW4gbWlub3IgcmVsZWFzZXMgb2YgYEBvcGVudGVsZW1ldHJ5L3NlbWFudGljLWNvbnZlbnRpb25zYC5cbiAqXG4gKiBAZGVwcmVjYXRlZCBSZXBsYWNlZCBieSBgZGIub3BlcmF0aW9uLm5hbWVgLlxuICovXG5leHBvcnRzLkFUVFJfREJfT1BFUkFUSU9OID0gJ2RiLm9wZXJhdGlvbic7XG4vKipcbiAqIFRoZSBkYXRhYmFzZSBzdGF0ZW1lbnQgYmVpbmcgZXhlY3V0ZWQuXG4gKlxuICogQGV4YW1wbGUgU0VMRUNUICogRlJPTSB3dXNlcl90YWJsZVxuICogQGV4YW1wbGUgU0VUIG15a2V5IFwiV3VWYWx1ZVwiXG4gKlxuICogQGV4cGVyaW1lbnRhbCBUaGlzIGF0dHJpYnV0ZSBpcyBleHBlcmltZW50YWwgYW5kIGlzIHN1YmplY3QgdG8gYnJlYWtpbmcgY2hhbmdlcyBpbiBtaW5vciByZWxlYXNlcyBvZiBgQG9wZW50ZWxlbWV0cnkvc2VtYW50aWMtY29udmVudGlvbnNgLlxuICpcbiAqIEBkZXByZWNhdGVkIFJlcGxhY2VkIGJ5IGBkYi5xdWVyeS50ZXh0YC5cbiAqL1xuZXhwb3J0cy5BVFRSX0RCX1NUQVRFTUVOVCA9ICdkYi5zdGF0ZW1lbnQnO1xuLyoqXG4gKiBEZXByZWNhdGVkLCB1c2UgYGRiLnN5c3RlbS5uYW1lYCBpbnN0ZWFkLlxuICpcbiAqIEBleHBlcmltZW50YWwgVGhpcyBhdHRyaWJ1dGUgaXMgZXhwZXJpbWVudGFsIGFuZCBpcyBzdWJqZWN0IHRvIGJyZWFraW5nIGNoYW5nZXMgaW4gbWlub3IgcmVsZWFzZXMgb2YgYEBvcGVudGVsZW1ldHJ5L3NlbWFudGljLWNvbnZlbnRpb25zYC5cbiAqXG4gKiBAZGVwcmVjYXRlZCBSZXBsYWNlZCBieSBgZGIuc3lzdGVtLm5hbWVgLlxuICovXG5leHBvcnRzLkFUVFJfREJfU1lTVEVNID0gJ2RiLnN5c3RlbSc7XG4vKipcbiAqIERlcHJlY2F0ZWQsIG5vIHJlcGxhY2VtZW50IGF0IHRoaXMgdGltZS5cbiAqXG4gKiBAZXhhbXBsZSByZWFkb25seV91c2VyXG4gKiBAZXhhbXBsZSByZXBvcnRpbmdfdXNlclxuICpcbiAqIEBleHBlcmltZW50YWwgVGhpcyBhdHRyaWJ1dGUgaXMgZXhwZXJpbWVudGFsIGFuZCBpcyBzdWJqZWN0IHRvIGJyZWFraW5nIGNoYW5nZXMgaW4gbWlub3IgcmVsZWFzZXMgb2YgYEBvcGVudGVsZW1ldHJ5L3NlbWFudGljLWNvbnZlbnRpb25zYC5cbiAqXG4gKiBAZGVwcmVjYXRlZCBSZW1vdmVkLCBubyByZXBsYWNlbWVudCBhdCB0aGlzIHRpbWUuXG4gKi9cbmV4cG9ydHMuQVRUUl9EQl9VU0VSID0gJ2RiLnVzZXInO1xuLyoqXG4gKiBEZXByZWNhdGVkLCB1c2UgYHNlcnZlci5hZGRyZXNzYCBvbiBjbGllbnQgc3BhbnMgYW5kIGBjbGllbnQuYWRkcmVzc2Agb24gc2VydmVyIHNwYW5zLlxuICpcbiAqIEBleGFtcGxlIGV4YW1wbGUuY29tXG4gKlxuICogQGV4cGVyaW1lbnRhbCBUaGlzIGF0dHJpYnV0ZSBpcyBleHBlcmltZW50YWwgYW5kIGlzIHN1YmplY3QgdG8gYnJlYWtpbmcgY2hhbmdlcyBpbiBtaW5vciByZWxlYXNlcyBvZiBgQG9wZW50ZWxlbWV0cnkvc2VtYW50aWMtY29udmVudGlvbnNgLlxuICpcbiAqIEBkZXByZWNhdGVkIFJlcGxhY2VkIGJ5IGBzZXJ2ZXIuYWRkcmVzc2Agb24gY2xpZW50IHNwYW5zIGFuZCBgY2xpZW50LmFkZHJlc3NgIG9uIHNlcnZlciBzcGFucy5cbiAqL1xuZXhwb3J0cy5BVFRSX05FVF9QRUVSX05BTUUgPSAnbmV0LnBlZXIubmFtZSc7XG4vKipcbiAqIERlcHJlY2F0ZWQsIHVzZSBgc2VydmVyLnBvcnRgIG9uIGNsaWVudCBzcGFucyBhbmQgYGNsaWVudC5wb3J0YCBvbiBzZXJ2ZXIgc3BhbnMuXG4gKlxuICogQGV4YW1wbGUgODA4MFxuICpcbiAqIEBleHBlcmltZW50YWwgVGhpcyBhdHRyaWJ1dGUgaXMgZXhwZXJpbWVudGFsIGFuZCBpcyBzdWJqZWN0IHRvIGJyZWFraW5nIGNoYW5nZXMgaW4gbWlub3IgcmVsZWFzZXMgb2YgYEBvcGVudGVsZW1ldHJ5L3NlbWFudGljLWNvbnZlbnRpb25zYC5cbiAqXG4gKiBAZGVwcmVjYXRlZCBSZXBsYWNlZCBieSBgc2VydmVyLnBvcnRgIG9uIGNsaWVudCBzcGFucyBhbmQgYGNsaWVudC5wb3J0YCBvbiBzZXJ2ZXIgc3BhbnMuXG4gKi9cbmV4cG9ydHMuQVRUUl9ORVRfUEVFUl9QT1JUID0gJ25ldC5wZWVyLnBvcnQnO1xuLyoqXG4gKiBFbnVtIHZhbHVlIFwibW9uZ29kYlwiIGZvciBhdHRyaWJ1dGUge0BsaW5rIEFUVFJfREJfU1lTVEVNX05BTUV9LlxuICpcbiAqIFtNb25nb0RCXShodHRwczovL3d3dy5tb25nb2RiLmNvbS8pXG4gKlxuICogQGV4cGVyaW1lbnRhbCBUaGlzIGVudW0gdmFsdWUgaXMgZXhwZXJpbWVudGFsIGFuZCBpcyBzdWJqZWN0IHRvIGJyZWFraW5nIGNoYW5nZXMgaW4gbWlub3IgcmVsZWFzZXMgb2YgYEBvcGVudGVsZW1ldHJ5L3NlbWFudGljLWNvbnZlbnRpb25zYC5cbiAqL1xuZXhwb3J0cy5EQl9TWVNURU1fTkFNRV9WQUxVRV9NT05HT0RCID0gJ21vbmdvZGInO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VtY29udi5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/semconv.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/utils.js":
/*!****************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/utils.js ***!
  \****************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.handleCallbackResponse = exports.handlePromiseResponse = exports.getAttributesFromCollection = void 0;\n/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst api_1 = __webpack_require__(/*! @opentelemetry/api */ \"(ssr)/./node_modules/.pnpm/@opentelemetry+api@1.9.0/node_modules/@opentelemetry/api/build/esm/index.js\");\nconst instrumentation_1 = __webpack_require__(/*! @opentelemetry/instrumentation */ \"(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation@0.211.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation/build/esm/index.js\");\nconst semconv_1 = __webpack_require__(/*! ./semconv */ \"(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/semconv.js\");\nconst semantic_conventions_1 = __webpack_require__(/*! @opentelemetry/semantic-conventions */ \"(ssr)/./node_modules/.pnpm/@opentelemetry+semantic-conventions@1.39.0/node_modules/@opentelemetry/semantic-conventions/build/esm/index.js\");\nfunction getAttributesFromCollection(collection, dbSemconvStability, netSemconvStability) {\n    const attrs = {};\n    if (dbSemconvStability & instrumentation_1.SemconvStability.OLD) {\n        attrs[semconv_1.ATTR_DB_MONGODB_COLLECTION] = collection.name;\n        attrs[semconv_1.ATTR_DB_NAME] = collection.conn.name;\n        attrs[semconv_1.ATTR_DB_USER] = collection.conn.user;\n    }\n    if (dbSemconvStability & instrumentation_1.SemconvStability.STABLE) {\n        attrs[semantic_conventions_1.ATTR_DB_COLLECTION_NAME] = collection.name;\n        attrs[semantic_conventions_1.ATTR_DB_NAMESPACE] = collection.conn.name;\n        // db.user has no stable replacement\n    }\n    if (netSemconvStability & instrumentation_1.SemconvStability.OLD) {\n        attrs[semconv_1.ATTR_NET_PEER_NAME] = collection.conn.host;\n        attrs[semconv_1.ATTR_NET_PEER_PORT] = collection.conn.port;\n    }\n    if (netSemconvStability & instrumentation_1.SemconvStability.STABLE) {\n        attrs[semantic_conventions_1.ATTR_SERVER_ADDRESS] = collection.conn.host;\n        attrs[semantic_conventions_1.ATTR_SERVER_PORT] = collection.conn.port;\n    }\n    return attrs;\n}\nexports.getAttributesFromCollection = getAttributesFromCollection;\nfunction setErrorStatus(span, error = {}) {\n    span.recordException(error);\n    span.setStatus({\n        code: api_1.SpanStatusCode.ERROR,\n        message: `${error.message} ${error.code ? `\\nMongoose Error Code: ${error.code}` : ''}`,\n    });\n}\nfunction applyResponseHook(span, response, responseHook, moduleVersion = undefined) {\n    if (!responseHook) {\n        return;\n    }\n    (0, instrumentation_1.safeExecuteInTheMiddle)(() => responseHook(span, { moduleVersion, response }), e => {\n        if (e) {\n            api_1.diag.error('mongoose instrumentation: responseHook error', e);\n        }\n    }, true);\n}\nfunction handlePromiseResponse(execResponse, span, responseHook, moduleVersion = undefined) {\n    if (!(execResponse instanceof Promise)) {\n        applyResponseHook(span, execResponse, responseHook, moduleVersion);\n        span.end();\n        return execResponse;\n    }\n    return execResponse\n        .then(response => {\n        applyResponseHook(span, response, responseHook, moduleVersion);\n        return response;\n    })\n        .catch(err => {\n        setErrorStatus(span, err);\n        throw err;\n    })\n        .finally(() => span.end());\n}\nexports.handlePromiseResponse = handlePromiseResponse;\nfunction handleCallbackResponse(callback, exec, originalThis, span, args, responseHook, moduleVersion = undefined) {\n    let callbackArgumentIndex = 0;\n    if (args.length === 2) {\n        callbackArgumentIndex = 1;\n    }\n    else if (args.length === 3) {\n        callbackArgumentIndex = 2;\n    }\n    args[callbackArgumentIndex] = (err, response) => {\n        if (err) {\n            setErrorStatus(span, err);\n        }\n        else {\n            applyResponseHook(span, response, responseHook, moduleVersion);\n        }\n        span.end();\n        return callback(err, response);\n    };\n    return exec.apply(originalThis, args);\n}\nexports.handleCallbackResponse = handleCallbackResponse;\n//# sourceMappingURL=utils.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQG9wZW50ZWxlbWV0cnkraW5zdHJ1bWVudGF0aW9uLW1vbmdvb3NlQDAuNTcuMF9Ab3BlbnRlbGVtZXRyeSthcGlAMS45LjAvbm9kZV9tb2R1bGVzL0BvcGVudGVsZW1ldHJ5L2luc3RydW1lbnRhdGlvbi1tb25nb29zZS9idWlsZC9zcmMvdXRpbHMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsOEJBQThCLEdBQUcsNkJBQTZCLEdBQUcsbUNBQW1DO0FBQ3BHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsbUJBQU8sQ0FBQyxrSUFBb0I7QUFDMUMsMEJBQTBCLG1CQUFPLENBQUMsaU1BQWdDO0FBQ2xFLGtCQUFrQixtQkFBTyxDQUFDLCtMQUFXO0FBQ3JDLCtCQUErQixtQkFBTyxDQUFDLHNMQUFxQztBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQztBQUNuQyx3Q0FBd0M7QUFDeEM7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGVBQWUsRUFBRSx1Q0FBdUMsV0FBVyxPQUFPO0FBQzlGLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkVBQTZFLHlCQUF5QjtBQUN0RztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCO0FBQzlCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbGVpaW5kaWFzLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BvcGVudGVsZW1ldHJ5K2luc3RydW1lbnRhdGlvbi1tb25nb29zZUAwLjU3LjBfQG9wZW50ZWxlbWV0cnkrYXBpQDEuOS4wL25vZGVfbW9kdWxlcy9Ab3BlbnRlbGVtZXRyeS9pbnN0cnVtZW50YXRpb24tbW9uZ29vc2UvYnVpbGQvc3JjL3V0aWxzLmpzP2JmMDQiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmhhbmRsZUNhbGxiYWNrUmVzcG9uc2UgPSBleHBvcnRzLmhhbmRsZVByb21pc2VSZXNwb25zZSA9IGV4cG9ydHMuZ2V0QXR0cmlidXRlc0Zyb21Db2xsZWN0aW9uID0gdm9pZCAwO1xuLypcbiAqIENvcHlyaWdodCBUaGUgT3BlblRlbGVtZXRyeSBBdXRob3JzXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cHM6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IGFwaV8xID0gcmVxdWlyZShcIkBvcGVudGVsZW1ldHJ5L2FwaVwiKTtcbmNvbnN0IGluc3RydW1lbnRhdGlvbl8xID0gcmVxdWlyZShcIkBvcGVudGVsZW1ldHJ5L2luc3RydW1lbnRhdGlvblwiKTtcbmNvbnN0IHNlbWNvbnZfMSA9IHJlcXVpcmUoXCIuL3NlbWNvbnZcIik7XG5jb25zdCBzZW1hbnRpY19jb252ZW50aW9uc18xID0gcmVxdWlyZShcIkBvcGVudGVsZW1ldHJ5L3NlbWFudGljLWNvbnZlbnRpb25zXCIpO1xuZnVuY3Rpb24gZ2V0QXR0cmlidXRlc0Zyb21Db2xsZWN0aW9uKGNvbGxlY3Rpb24sIGRiU2VtY29udlN0YWJpbGl0eSwgbmV0U2VtY29udlN0YWJpbGl0eSkge1xuICAgIGNvbnN0IGF0dHJzID0ge307XG4gICAgaWYgKGRiU2VtY29udlN0YWJpbGl0eSAmIGluc3RydW1lbnRhdGlvbl8xLlNlbWNvbnZTdGFiaWxpdHkuT0xEKSB7XG4gICAgICAgIGF0dHJzW3NlbWNvbnZfMS5BVFRSX0RCX01PTkdPREJfQ09MTEVDVElPTl0gPSBjb2xsZWN0aW9uLm5hbWU7XG4gICAgICAgIGF0dHJzW3NlbWNvbnZfMS5BVFRSX0RCX05BTUVdID0gY29sbGVjdGlvbi5jb25uLm5hbWU7XG4gICAgICAgIGF0dHJzW3NlbWNvbnZfMS5BVFRSX0RCX1VTRVJdID0gY29sbGVjdGlvbi5jb25uLnVzZXI7XG4gICAgfVxuICAgIGlmIChkYlNlbWNvbnZTdGFiaWxpdHkgJiBpbnN0cnVtZW50YXRpb25fMS5TZW1jb252U3RhYmlsaXR5LlNUQUJMRSkge1xuICAgICAgICBhdHRyc1tzZW1hbnRpY19jb252ZW50aW9uc18xLkFUVFJfREJfQ09MTEVDVElPTl9OQU1FXSA9IGNvbGxlY3Rpb24ubmFtZTtcbiAgICAgICAgYXR0cnNbc2VtYW50aWNfY29udmVudGlvbnNfMS5BVFRSX0RCX05BTUVTUEFDRV0gPSBjb2xsZWN0aW9uLmNvbm4ubmFtZTtcbiAgICAgICAgLy8gZGIudXNlciBoYXMgbm8gc3RhYmxlIHJlcGxhY2VtZW50XG4gICAgfVxuICAgIGlmIChuZXRTZW1jb252U3RhYmlsaXR5ICYgaW5zdHJ1bWVudGF0aW9uXzEuU2VtY29udlN0YWJpbGl0eS5PTEQpIHtcbiAgICAgICAgYXR0cnNbc2VtY29udl8xLkFUVFJfTkVUX1BFRVJfTkFNRV0gPSBjb2xsZWN0aW9uLmNvbm4uaG9zdDtcbiAgICAgICAgYXR0cnNbc2VtY29udl8xLkFUVFJfTkVUX1BFRVJfUE9SVF0gPSBjb2xsZWN0aW9uLmNvbm4ucG9ydDtcbiAgICB9XG4gICAgaWYgKG5ldFNlbWNvbnZTdGFiaWxpdHkgJiBpbnN0cnVtZW50YXRpb25fMS5TZW1jb252U3RhYmlsaXR5LlNUQUJMRSkge1xuICAgICAgICBhdHRyc1tzZW1hbnRpY19jb252ZW50aW9uc18xLkFUVFJfU0VSVkVSX0FERFJFU1NdID0gY29sbGVjdGlvbi5jb25uLmhvc3Q7XG4gICAgICAgIGF0dHJzW3NlbWFudGljX2NvbnZlbnRpb25zXzEuQVRUUl9TRVJWRVJfUE9SVF0gPSBjb2xsZWN0aW9uLmNvbm4ucG9ydDtcbiAgICB9XG4gICAgcmV0dXJuIGF0dHJzO1xufVxuZXhwb3J0cy5nZXRBdHRyaWJ1dGVzRnJvbUNvbGxlY3Rpb24gPSBnZXRBdHRyaWJ1dGVzRnJvbUNvbGxlY3Rpb247XG5mdW5jdGlvbiBzZXRFcnJvclN0YXR1cyhzcGFuLCBlcnJvciA9IHt9KSB7XG4gICAgc3Bhbi5yZWNvcmRFeGNlcHRpb24oZXJyb3IpO1xuICAgIHNwYW4uc2V0U3RhdHVzKHtcbiAgICAgICAgY29kZTogYXBpXzEuU3BhblN0YXR1c0NvZGUuRVJST1IsXG4gICAgICAgIG1lc3NhZ2U6IGAke2Vycm9yLm1lc3NhZ2V9ICR7ZXJyb3IuY29kZSA/IGBcXG5Nb25nb29zZSBFcnJvciBDb2RlOiAke2Vycm9yLmNvZGV9YCA6ICcnfWAsXG4gICAgfSk7XG59XG5mdW5jdGlvbiBhcHBseVJlc3BvbnNlSG9vayhzcGFuLCByZXNwb25zZSwgcmVzcG9uc2VIb29rLCBtb2R1bGVWZXJzaW9uID0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKCFyZXNwb25zZUhvb2spIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAoMCwgaW5zdHJ1bWVudGF0aW9uXzEuc2FmZUV4ZWN1dGVJblRoZU1pZGRsZSkoKCkgPT4gcmVzcG9uc2VIb29rKHNwYW4sIHsgbW9kdWxlVmVyc2lvbiwgcmVzcG9uc2UgfSksIGUgPT4ge1xuICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgYXBpXzEuZGlhZy5lcnJvcignbW9uZ29vc2UgaW5zdHJ1bWVudGF0aW9uOiByZXNwb25zZUhvb2sgZXJyb3InLCBlKTtcbiAgICAgICAgfVxuICAgIH0sIHRydWUpO1xufVxuZnVuY3Rpb24gaGFuZGxlUHJvbWlzZVJlc3BvbnNlKGV4ZWNSZXNwb25zZSwgc3BhbiwgcmVzcG9uc2VIb29rLCBtb2R1bGVWZXJzaW9uID0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKCEoZXhlY1Jlc3BvbnNlIGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcbiAgICAgICAgYXBwbHlSZXNwb25zZUhvb2soc3BhbiwgZXhlY1Jlc3BvbnNlLCByZXNwb25zZUhvb2ssIG1vZHVsZVZlcnNpb24pO1xuICAgICAgICBzcGFuLmVuZCgpO1xuICAgICAgICByZXR1cm4gZXhlY1Jlc3BvbnNlO1xuICAgIH1cbiAgICByZXR1cm4gZXhlY1Jlc3BvbnNlXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgYXBwbHlSZXNwb25zZUhvb2soc3BhbiwgcmVzcG9uc2UsIHJlc3BvbnNlSG9vaywgbW9kdWxlVmVyc2lvbik7XG4gICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgc2V0RXJyb3JTdGF0dXMoc3BhbiwgZXJyKTtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgIH0pXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHNwYW4uZW5kKCkpO1xufVxuZXhwb3J0cy5oYW5kbGVQcm9taXNlUmVzcG9uc2UgPSBoYW5kbGVQcm9taXNlUmVzcG9uc2U7XG5mdW5jdGlvbiBoYW5kbGVDYWxsYmFja1Jlc3BvbnNlKGNhbGxiYWNrLCBleGVjLCBvcmlnaW5hbFRoaXMsIHNwYW4sIGFyZ3MsIHJlc3BvbnNlSG9vaywgbW9kdWxlVmVyc2lvbiA9IHVuZGVmaW5lZCkge1xuICAgIGxldCBjYWxsYmFja0FyZ3VtZW50SW5kZXggPSAwO1xuICAgIGlmIChhcmdzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICBjYWxsYmFja0FyZ3VtZW50SW5kZXggPSAxO1xuICAgIH1cbiAgICBlbHNlIGlmIChhcmdzLmxlbmd0aCA9PT0gMykge1xuICAgICAgICBjYWxsYmFja0FyZ3VtZW50SW5kZXggPSAyO1xuICAgIH1cbiAgICBhcmdzW2NhbGxiYWNrQXJndW1lbnRJbmRleF0gPSAoZXJyLCByZXNwb25zZSkgPT4ge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBzZXRFcnJvclN0YXR1cyhzcGFuLCBlcnIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYXBwbHlSZXNwb25zZUhvb2soc3BhbiwgcmVzcG9uc2UsIHJlc3BvbnNlSG9vaywgbW9kdWxlVmVyc2lvbik7XG4gICAgICAgIH1cbiAgICAgICAgc3Bhbi5lbmQoKTtcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGVyciwgcmVzcG9uc2UpO1xuICAgIH07XG4gICAgcmV0dXJuIGV4ZWMuYXBwbHkob3JpZ2luYWxUaGlzLCBhcmdzKTtcbn1cbmV4cG9ydHMuaGFuZGxlQ2FsbGJhY2tSZXNwb25zZSA9IGhhbmRsZUNhbGxiYWNrUmVzcG9uc2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD11dGlscy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/utils.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/version.js":
/*!******************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/version.js ***!
  \******************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\n/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.PACKAGE_NAME = exports.PACKAGE_VERSION = void 0;\n// this is autogenerated file, see scripts/version-update.js\nexports.PACKAGE_VERSION = '0.57.0';\nexports.PACKAGE_NAME = '@opentelemetry/instrumentation-mongoose';\n//# sourceMappingURL=version.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQG9wZW50ZWxlbWV0cnkraW5zdHJ1bWVudGF0aW9uLW1vbmdvb3NlQDAuNTcuMF9Ab3BlbnRlbGVtZXRyeSthcGlAMS45LjAvbm9kZV9tb2R1bGVzL0BvcGVudGVsZW1ldHJ5L2luc3RydW1lbnRhdGlvbi1tb25nb29zZS9idWlsZC9zcmMvdmVyc2lvbi5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxvQkFBb0IsR0FBRyx1QkFBdUI7QUFDOUM7QUFDQSx1QkFBdUI7QUFDdkIsb0JBQW9CO0FBQ3BCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbGVpaW5kaWFzLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BvcGVudGVsZW1ldHJ5K2luc3RydW1lbnRhdGlvbi1tb25nb29zZUAwLjU3LjBfQG9wZW50ZWxlbWV0cnkrYXBpQDEuOS4wL25vZGVfbW9kdWxlcy9Ab3BlbnRlbGVtZXRyeS9pbnN0cnVtZW50YXRpb24tbW9uZ29vc2UvYnVpbGQvc3JjL3ZlcnNpb24uanM/MzRmOSJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbi8qXG4gKiBDb3B5cmlnaHQgVGhlIE9wZW5UZWxlbWV0cnkgQXV0aG9yc1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHBzOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLlBBQ0tBR0VfTkFNRSA9IGV4cG9ydHMuUEFDS0FHRV9WRVJTSU9OID0gdm9pZCAwO1xuLy8gdGhpcyBpcyBhdXRvZ2VuZXJhdGVkIGZpbGUsIHNlZSBzY3JpcHRzL3ZlcnNpb24tdXBkYXRlLmpzXG5leHBvcnRzLlBBQ0tBR0VfVkVSU0lPTiA9ICcwLjU3LjAnO1xuZXhwb3J0cy5QQUNLQUdFX05BTUUgPSAnQG9wZW50ZWxlbWV0cnkvaW5zdHJ1bWVudGF0aW9uLW1vbmdvb3NlJztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZlcnNpb24uanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@opentelemetry+instrumentation-mongoose@0.57.0_@opentelemetry+api@1.9.0/node_modules/@opentelemetry/instrumentation-mongoose/build/src/version.js\n");

/***/ })

};
;