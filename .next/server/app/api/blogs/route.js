"use strict";(()=>{var e={};e.id=1878,e.ids=[1878],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},8678:e=>{e.exports=import("pg")},18168:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>p,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>h,staticGenerationAsyncStorage:()=>d});var s=r(12085),n=r(31650),a=r(85980),i=r(5570),u=e([i]);i=(u.then?(await u)():u)[0];let c=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/blogs/route",pathname:"/api/blogs",filename:"route",bundlePath:"app/api/blogs/route"},resolvedPagePath:"/home/stark/leiindias/app/api/blogs/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:h}=c,g="/api/blogs/route";function p(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:d})}o()}catch(e){o(e)}})},5570:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{GET:()=>u});var s=r(30627),n=r(83136),a=r(17261),i=e([n]);async function u(e){try{let t=e.headers.get("authorization"),r=!1;if(t&&t.startsWith("Bearer ")){let e=t.substring(7),o=(0,a.W)(e);o&&("admin"===o.role||"superadmin"===o.role)&&(r=!0)}let o=await n.w.query(`
      SELECT id, title, excerpt, content, author, category, image, published,
             "publishedAt", "createdAt", "updatedAt"
      FROM "Blog"
      ${r?"":"WHERE published = true"}
      ORDER BY "createdAt" DESC
      `);return s.NextResponse.json(o.rows)}catch(e){return console.error("Failed to fetch blogs:",e),s.NextResponse.json({error:"Failed to fetch blogs"},{status:500})}}n=(i.then?(await i)():i)[0],o()}catch(e){o(e)}})},17261:(e,t,r)=>{r.d(t,{R:()=>i,W:()=>u});var o=r(57946),s=r.n(o);let n=process.env.JWT_SECRET||"",a=process.env.JWT_EXPIRES_IN||"7d";if(!n)throw Error("JWT_SECRET environment variable must be set in production");function i(e,t="customer"){if(!n)throw Error("JWT_SECRET is not configured");return s().sign({username:e,role:t},n,{expiresIn:a})}function u(e){try{if(!n)return null;return s().verify(e,n)}catch{return null}}},83136:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.d(t,{w:()=>a});var s=r(8678),n=e([s]);if(s=(n.then?(await n)():n)[0],!process.env.DATABASE_URL)throw Error("DATABASE_URL must be set for Postgres connections");let a=new s.Pool({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}});o()}catch(e){o(e)}})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[6522,8247,7946],()=>r(18168));module.exports=o})();